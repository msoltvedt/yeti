{"file":"yeti-field.entry.esm.js","mappings":"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","names":[],"sources":["src/components/yeti-field/yeti-field.tsx"],"sourcesContent":["import { Component, Prop, h, State, Watch, Listen, Element } from '@stencil/core';\r\nimport { utils } from '../../utils/utils';\r\n\r\n@Component({\r\n  tag: 'yeti-field',\r\n  shadow: false,\r\n})\r\nexport class YetiField {\r\n\r\n  @Element() el: HTMLElement;\r\n\r\n  /**\r\n   * id that will be assigned to the actual input element. A unique one will be assigned if one is not provided.\r\n   */\r\n  @Prop() inputId: string = utils.generateUniqueId();\r\n\r\n  /**\r\n   * name that will be assigned to the actual input element. id will be assigned if one is not provided.\r\n   */\r\n  @Prop() inputName: string = this.inputId;\r\n\r\n  /**\r\n   * type that will be assigned to the actual input element.\r\n   */\r\n  @Prop() type: string = \"text\";\r\n\r\n  /**\r\n   * CSS classlist that will be assigned to the containing field element (probably a div).\r\n   */\r\n  @Prop() fieldClass: string = \"\";\r\n\r\n  /**\r\n   * maximum length for the field.\r\n   */\r\n  @Prop() inputMaxlength?: number = 0;\r\n  \r\n  /**\r\n   * Mandatory value for the label of the field.\r\n   */\r\n  @Prop() label!: string;\r\n  @Watch('label')\r\n  validateLabel(newValue: string) {\r\n    // Label must have a non-empty value.\r\n    const isInvalid = typeof newValue !== 'string' || newValue === '';\r\n    if (isInvalid) {\r\n      throw new Error('yeti-field must have a non-empty label attribute');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Value for the optional input tip that appears at the bottom of the field.\r\n   */\r\n  @Prop() tip: string = \"\";\r\n\r\n  /**\r\n   * Whether the field is required to have a valid value by the greater form.\r\n   */\r\n  @Prop() required: boolean = false;\r\n\r\n  /**\r\n   * Error message that appears when the field is invalid. Can be updated at any time.\r\n   */\r\n  @Prop({mutable: true}) errorMessage: string = 'Error: please correct this field.'\r\n\r\n  /**\r\n   * Whether the input is currently valid or invalid.\r\n   */\r\n  @Prop({\r\n    mutable: true,\r\n    reflect: true\r\n  }) isValid: boolean = true;\r\n  @Watch('isValid')\r\n  updateSlottedContentForErrorState(newValue: string) {\r\n    if (!this.hasSlottedField) {\r\n      return; // We don't need to do anything here unless the form element comes via slotted content.\r\n    }\r\n\r\n    let element = this.el.querySelector(`#${this.inputId}`);\r\n\r\n    if (element) {\r\n\r\n      if (newValue) {\r\n        element.classList.add(\"yeti-input__error\");\r\n      } else {\r\n        element.classList.remove(\"yeti-input__error\");\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Default value of the field's input.\r\n   */\r\n  @Prop() defaultValue: string = '';\r\n\r\n  /**\r\n   * Determines whether the field should attempt to validate itself or merely pass through any readyToVerify events from its input.\r\n   */\r\n  @Prop({\r\n    mutable: true,\r\n    reflect: true\r\n  }) autovalidate: boolean = true;\r\n\r\n  /**\r\n   * Determines whether the field uses block (default) or inline labels.\r\n   */\r\n  @Prop() isInline: boolean = false;\r\n\r\n  /**\r\n   * Tracks whether the field's input has been focused and then blurred (i.e. if the user has interacted with it yet).\r\n   */\r\n  @State() isDirty: boolean = false;\r\n  \r\n  @Listen('readyToVerifySlow', { capture: true })\r\n  handleReadyToVerifySlow(ev) {\r\n\r\n    let childControl = ev.target;\r\n\r\n    if (this.autovalidate == false) {\r\n      return;\r\n    }\r\n\r\n    if (this.required) {\r\n\r\n      // Autoverification is on, this field is required, and the child component just notified us that it's ready for verification.\r\n\r\n      // First, regardless of whether it's an input or date-picker, it can't be empty.\r\n      if (childControl.value == \"\") {\r\n\r\n        this.errorMessage = `${this.label} field is required.`\r\n        this.isValid = false;\r\n        return;\r\n\r\n      }\r\n      \r\n    } else if (childControl.nodeName.toLowerCase() == \"yeti-date-picker\") {\r\n\r\n      // Second, if it's a non-empty date-picker, see if it's a valid date.\r\n\r\n      if (!childControl.isValid) {\r\n\r\n        // The date-picker already validates itself. We just need to check its status.\r\n        this.errorMessage = 'Enter the date in mm/dd/yyyy format.'\r\n        this.isValid = false;\r\n        return;\r\n\r\n      }\r\n    }\r\n\r\n    this.isValid = true;\r\n\r\n  }\r\n\r\n\r\n  tipId = utils.generateUniqueId();\r\n  hasSlottedField: boolean = false;\r\n\r\n\r\n\r\n  componentWillLoad() {\r\n    \r\n    let potentiallySlottedElement = this.el.querySelector('[slot=\"element\"]');\r\n\r\n    if (potentiallySlottedElement) {\r\n\r\n      this.hasSlottedField = true;\r\n      this.autovalidate = false; // We can't autovalidate a slotted element provided by the user\r\n\r\n      // See if the slotted element has an id\r\n      if (potentiallySlottedElement.id) {\r\n        this.inputId = potentiallySlottedElement.id; // It does, so replace the auto-generated default with the user-provided one.\r\n      } else {\r\n        potentiallySlottedElement.id = this.inputId; // It doesn't, so assign the auto-generated default one.\r\n      }\r\n\r\n      // See if the slotted element has a name\r\n      if (potentiallySlottedElement.hasAttribute(\"name\")) {\r\n        this.inputName = potentiallySlottedElement.getAttribute(\"name\"); // It does, so replace the auto-generated default with the user-provided one.\r\n      } else {\r\n        potentiallySlottedElement.setAttribute(\"name\", this.inputName);  // It doesn't, so assign the auto-generated default one.\r\n      }\r\n\r\n      // Connect the slotted element to the tip\r\n      if (this.tip != \"\") {\r\n        potentiallySlottedElement.setAttribute(\"aria-describedby\", this.tipId);\r\n      }\r\n\r\n      // Add the error class if necessary\r\n      if (!this.isValid) {\r\n        potentiallySlottedElement.classList.add(\"yeti-input__error\");\r\n      }\r\n\r\n    }\r\n    \r\n  }\r\n\r\n\r\n\r\n  render() {\r\n\r\n    let cssClass = \"yeti-form-field\";\r\n\r\n    if (this.isInline) {\r\n      cssClass += \" yeti-form-field-inline\";\r\n    }\r\n\r\n    this.validateLabel(this.label);\r\n\r\n    if (this.fieldClass != \"\") {\r\n      cssClass =\"yeti-form-field \" + this.fieldClass;\r\n    }\r\n\r\n    return (\r\n      <div class={cssClass}>\r\n\r\n        <label htmlFor={this.inputId} class=\"yeti-form-label\">{this.label}{this.required ? ' (required)' : null}</label>\r\n\r\n        {(!this.hasSlottedField) ?\r\n\r\n            (this.type == \"date\") ?\r\n\r\n              <yeti-date-picker\r\n                input-id={this.inputId}\r\n                input-name={this.inputName}\r\n                value={this.defaultValue}\r\n                required={this.required}\r\n                is-valid={this.isValid}\r\n                described-by={this.tipId}\r\n              ></yeti-date-picker>\r\n\r\n            :\r\n          \r\n              <yeti-input \r\n                input-id={this.inputId} \r\n                input-class={!this.isValid ? 'yeti-input__error' : null} \r\n                value={this.defaultValue} \r\n                required={this.required}\r\n                is-valid={this.isValid}\r\n                described-by={this.tipId}\r\n                {...((this.inputMaxlength != 0) ? {\"input-maxlength\": this.inputMaxlength} : {})}\r\n              ></yeti-input>\r\n\r\n        :\r\n\r\n          <slot name=\"element\"></slot>\r\n\r\n        }\r\n        \r\n        {\r\n          (this.tip != \"\" || (this.errorMessage != \"\" && !this.isValid)) ?\r\n\r\n            <span class=\"yeti-form-tip\" aria-live=\"polite\" id={this.tipId}>{\r\n\r\n                  !this.isValid\r\n                  ? this.errorMessage\r\n                  : \r\n                    this.tip\r\n                    ? this.tip\r\n                    : null\r\n\r\n            }</span>\r\n\r\n          :\r\n            \"\"\r\n        }\r\n        \r\n      </div>\r\n    );\r\n  }\r\n\r\n}\r\n"],"version":3}