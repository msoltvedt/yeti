{"file":"yeti-modal.entry.esm.js","mappings":"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","names":[],"sources":["src/components/yeti-modal/yeti-modal.tsx"],"sourcesContent":["import { Component, Prop, State, h, Element, Watch, Listen } from '@stencil/core';\nimport { utils } from '../../utils/utils';\n\n@Component({\n  tag: 'yeti-modal',\n  shadow: false,\n})\nexport class YetiModal {\n\n  @Element() el: HTMLElement;\n\n  /**\n   * Whether or not it's the special Side Sheet variant of Modal.\n   */\n  @Prop() isSideSheet: boolean = false;\n\n  /**\n   * The string that will display in the modal's heading and serve as its title.\n   */\n  @Prop() heading: string = \"Modal Heading\";\n\n  /**\n   * The optional id of an element that describes the modal's content.\n   */\n  @Prop() describedBy: string = \"\";\n\n  /**\n   * The optional size of the modal (other than the default). Options are xl, l, s, xs.\n   */\n  @Prop() size: string = \"\";\n\n  /**\n   * Optional CSS classes to add to the modal element.\n   */\n  @Prop() modalClass: string = \"\";\n\n  /**\n   * Whether overflowing contents are shown via scrolling or clipped.\n   */\n  @Prop() isScrollable: boolean = true;\n\n  /**\n   * Tracks whether the Modal is displaying or not.\n   */\n  @Prop({\n    mutable: true,\n    reflect: true\n  }) isActive: boolean = false;\n  @Watch('isActive')\n  handleFocus(newValue: boolean) {\n    // When the Modal becomes active it should take focus away from whatever had it before, but\n    // we want to keep track of what that was so we can return focus if Modal becomes inactive.\n\n    // First, normal Modals have only two states: active and inactive (i.e. they don't use the isOpening and isClosing states)\n    if (!this.isSideSheet) {\n      // Becoming active, take focus\n      if (newValue) {\n        this.shouldStealFocus = true;\n        this.setBackgroundElementStyles(true);\n      }\n\n      // Becoming inactive, return focus\n      else {\n        this.shouldReturnFocus = true;\n        this.setBackgroundElementStyles(false);\n      }\n\n    // Side Sheet modals have four states: inactive, opening, active, and closing.\n    } else {\n\n      // It's a side sheet modal\n\n      if (newValue) {\n        // Side sheet modal becoming active\n        this.setBackgroundElementStyles(true);\n        this.isAnimating = true;\n      }\n\n      else {\n        this.isAnimating = true;\n      }\n    }\n\n\n  }\n\n  /**\n   * Choose to show the close icon (currently an X) or not\n   */\n  @Prop() showClose: boolean = true;\n\n  @State() isAnimating: boolean = false;\n\n  @State() isOpening: boolean = false;\n\n  @State() isClosing: boolean = false;\n\n\n  previouslyFocusedElement: HTMLElement = null; // So we can return focus to wherever the user was when the Loading component appeared.\n  bodyInnerWrapper: HTMLElement = null; // A div wrapped around everything in the body except the modal. Used to prevent background scrolling.\n  shouldStealFocus = false;\n  shouldReturnFocus = false;\n  hasOpened = false;\n  headingId = utils.generateUniqueId();\n  \n\n\n  setBackgroundElementStyles(modalIsActivating: boolean) {\n    if (modalIsActivating) {\n        document.body.classList.add(\"yeti-modal-has_active_modal\");\n    } else {\n        document.body.classList.remove(\"yeti-modal-has_active_modal\");\n    }\n  }\n\n\n\n  @Listen('keydown', { target: 'window'})\n  focusTrap(e) {\n\n    if (this.isActive && e.keyCode == 27 && this.showClose) { // Escape button\n        this.isActive = false;    \n    }\n\n  }\n\n\n\n  @Listen('transitionend')\n  handleTransitionEnd(e) {\n\n    if (!e.propertyName || e.propertyName != \"transform\") {\n      return;\n    }\n\n    if (this.isOpening) {\n\n      // Becoming active, take focus\n      this.previouslyFocusedElement = document.activeElement as HTMLElement;\n      this.handleInitialFocus();\n      this.isOpening = false;\n      this.hasOpened = true;\n\n    } else if (this.isClosing) {\n\n      this.setBackgroundElementStyles(false);\n      if (this.previouslyFocusedElement) {\n        this.previouslyFocusedElement.focus();\n      }\n      this.isClosing = false;\n\n    }\n\n    this.isAnimating = false;\n\n  }\n\n\n\n  handleInitialFocus() {\n    // Sets focus on the correct thing within the modal's content when it first opens. If nothing is focusable, uses the content area itself.\n    let contentArea = this.el.querySelector('.yeti-modal-content') as HTMLElement;\n    let firstFocusableContentItem = utils.aria.focusFirstDescendant(contentArea); // either false or an HTMLElement\n\n    if (!firstFocusableContentItem) {\n        // There is nothing focusable within the content of the modal, so make the content area itself focusable.\n        contentArea.setAttribute(\"tabIndex\", \"-1\");\n        contentArea.focus();\n    }\n  }\n\n\n\n  componentWillLoad() {\n    // Set up ids and handle slotted content\n    let componentId = this.el.getAttribute(\"id\");\n    let content = this.el.querySelector(\"yeti-modal-content\");\n    let buttons = this.el.querySelector(\"yeti-modal-buttons\");\n    let headerAction = this.el.querySelector(\"yeti-modal-header-action\");\n\n    if (!content) {\n        console.error(\"Yeti Modal components must have a yeti-modal-content element.\");\n    } else {\n        content.setAttribute(\"slot\", \"content\");\n    }\n\n    if (!buttons) {\n        console.error(\"Yeti Modal components must have a yeti-modal-buttons element.\");\n    } else {\n        buttons.setAttribute(\"slot\", \"buttons\");\n    }\n\n    if (headerAction) {\n      headerAction.setAttribute(\"slot\", \"header_action\");\n    }\n\n    if (!componentId || componentId == \"\") {\n      componentId = utils.generateUniqueId();\n      this.el.setAttribute(\"id\", componentId);\n    }\n\n    if (this.isActive) {\n      this.setBackgroundElementStyles(true);\n    }\n\n  }\n\n\n  render() {\n\n    let modalOverlayCSS = (this.isSideSheet) ? \"yeti-modal_ss-overlay\" : \"yeti-modal-overlay\";\n    let modalCSS = `yeti-modal${(this.isSideSheet) ? \" yeti-modal_ss\" : \"\"}`;\n    let modalProperties = {\n        \"role\": \"dialog\",\n        \"aria-modal\": \"true\",\n        \"aria-labelledby\": this.headingId\n    };\n\n    if (this.describedBy != \"\") {\n        modalProperties[\"aria-describedby\"] = this.describedBy;\n    }\n\n    modalOverlayCSS += (this.isActive || this.isAnimating) ? \"\" : \" yeti-modal-overlay__inert\";\n\n    modalOverlayCSS += (this.isOpening) ? \" yeti-modal__opening\" : \"\";\n    modalOverlayCSS += (this.hasOpened) ? \" yeti-modal__open\" : \"\";\n    modalOverlayCSS += (this.isClosing) ? \" yeti-modal__closing\" : \"\";\n\n    modalCSS += (this.size == \"\") ? \"\" : ` yeti-modal-size-${this.size}`;\n\n    modalCSS += (this.modalClass != \"\") ? ` ${this.modalClass}` : \"\";\n\n    modalCSS += (this.isScrollable) ? \"\" : \" yeti-modal__unscrollable\";\n\n    return (\n        <div class={modalOverlayCSS}>\n            \n            <div class=\"yeti-modal-bumper-front\" tabIndex={0}></div>\n\n\n            <div class={modalCSS} {...modalProperties}>\n        \n                <div class=\"yeti-modal-header\">\n                    <h1 class=\"yeti-modal-header-heading\" id={this.headingId}>{this.heading}</h1>\n\n                    <div class=\"yeti-modal-header-action\">\n                      <slot name=\"header_action\" />\n                    </div>\n\n                    {(this.showClose) ?\n\n                      <button class=\"yeti-modal-header-close yeti-button-ghost\" onClick={() => { this.isActive = false }}>\n                      <span class=\"material-icons\">close</span>\n                      </button>\n\n                    :\n\n                      null\n\n                    }\n                    \n                </div>\n\n        \n                <div class=\"yeti-modal-content\">\n\n                    <div class=\"yeti-modal-content-actual\">\n                      \n                      <slot name=\"content\" />\n                    \n                    </div>\n                    \n        \n                    <div class=\"yeti-modal-content-fade\"></div>\n        \n                </div>\n\n        \n                <div class=\"yeti-modal-actions\">\n\n                    <div class=\"yeti-modal-actions-buttons\">\n                    \n                        <slot name=\"buttons\" />\n                    \n                    </div>\n                \n                </div>\n        \n            </div>\n\n\n            <div class=\"yeti-modal-bumper-back\" tabIndex={0}></div>\n\n        </div>\n\n    );\n  }\n\n\n\n  componentDidRender() {\n    // Handle focus management. We can't do this when the property changes because the inactive state uses display: none,\n    // which interferes with the ability to accept focus depending on some race conditions.\n\n    // For regular modals...\n    if (this.shouldStealFocus) {\n      // Becoming active, take focus\n      this.previouslyFocusedElement = document.activeElement as HTMLElement;\n      this.handleInitialFocus();\n    }\n\n    if (this.shouldReturnFocus) {\n      // Becoming inactive, return focus\n      if (this.previouslyFocusedElement) {\n        this.previouslyFocusedElement.focus();\n      }\n    }\n\n    \n    // For side sheet modals\n    if (this.isAnimating) {\n      // It's a side sheet modal, and it's opening. Add the opening class to the overlay to initiate the CSS transition.\n      if (this.isActive) {\n        setTimeout(() => {\n          this.isOpening = true;\n          this.isClosing = false;\n        }, 1);\n      } else {\n        setTimeout(() => {\n          this.isOpening = false;\n          this.hasOpened = false;\n          this.isClosing = true;\n        }, 1);\n      }\n      \n    }\n\n    this.shouldStealFocus = false;\n    this.shouldReturnFocus = false;\n  }\n\n\n\n  componentDidLoad() {\n    let frontBumper = this.el.querySelector(\".yeti-modal-bumper-front\");\n    let backBumper  = this.el.querySelector(\".yeti-modal-bumper-back\");\n\n    frontBumper.addEventListener(\"focus\", () => {\n        utils.aria.focusLastDescendant(this.el.querySelector(\".yeti-modal\"));\n    });\n\n    backBumper.addEventListener(\"focus\", () => {\n        utils.aria.focusFirstDescendant(this.el.querySelector(\".yeti-modal\"));\n    });\n  }\n\n}"],"version":3}