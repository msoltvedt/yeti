{"version":3,"file":"yeti-reorderer.entry.esm.js","sources":["src/components/yeti-reorderer/yeti-reorderer.tsx"],"sourcesContent":["import { Component, Prop, h, State, Element, Event, EventEmitter, Listen } from '@stencil/core';\r\nimport { utils } from '../../utils/utils';\r\n\r\n@Component({\r\n  tag: 'yeti-reorderer',\r\n  shadow: false,\r\n})\r\nexport class YetiReorderer {\r\n\r\n  @Element() el: HTMLElement;\r\n\r\n\r\n  @Event() reorderCompleted: EventEmitter;\r\n\r\n\r\n  /**\r\n   * CSS class list that should apply to the top-most wrapper element.\r\n   */\r\n  @Prop() wrapperClass: string = '';\r\n\r\n  /**\r\n   * Used to toggle a re-render of the icon.\r\n   */\r\n  @State() iLoveJSX: boolean = false;\r\n\r\n\r\n  @Listen(\"reorderRequested\")\r\n  handleReorderRequested(event) {\r\n    let mover = this.el.querySelector(`#${event.detail.assignedId}`);\r\n    let moverPosition = event.detail.position;\r\n    let moverChild = mover.querySelector(\".yeti-reorderee\") as HTMLElement;\r\n    let moverRect = moverChild.getBoundingClientRect();\r\n    let isUp = event.detail.isUp;\r\n    let swapeePosition = (isUp) ? moverPosition - 1 : moverPosition + 1;\r\n    let swapee = this.el.querySelector(`[position='${swapeePosition}']`);\r\n    let swapeeChild = swapee.querySelector(\".yeti-reorderee\") as HTMLElement;\r\n    let swapeeRect = swapeeChild.getBoundingClientRect();\r\n    let moverYDelta = (isUp) ? swapeeRect.y - moverRect.y : /* i.e. just move it up to where the swapee is */\r\n      swapeeRect.height + (swapeeRect.y - moverRect.y - moverRect.height); // Move it down by height of swapee + distance between mover and swapee.\r\n    let swapeeYDelta = (isUp) ? moverRect.height + (moverRect.y - swapeeRect.y - swapeeRect.height) : moverRect.y - swapeeRect.y;\r\n    let that = this; // So we can reference the class object inside a proper function later on.\r\n\r\n    if (event.detail.isDisabled) {\r\n      // This is just to be safe; Reorderee should never emit a reorderRequested event on a disabled trigger.\r\n      return;\r\n    }\r\n    \r\n    // Move mover into swapee's place\r\n    moverChild.addEventListener('transitionend', handleTransitionEnd);\r\n    moverChild.style.setProperty('transition', 'transform 300ms');\r\n    swapeeChild.style.setProperty('transition', 'transform 300ms');\r\n    moverChild.style.setProperty('transform', `translateY(${moverYDelta}px)`);\r\n    swapeeChild.style.setProperty('transform', `translateY(${swapeeYDelta}px)`);\r\n\r\n    function handleTransitionEnd() {\r\n      let placement = ((isUp) ? 'beforebegin' : 'afterend') as InsertPosition;\r\n      swapee.insertAdjacentElement(placement, mover);\r\n      moverChild.style.removeProperty('transition');\r\n      swapeeChild.style.removeProperty('transition');\r\n      moverChild.style.removeProperty('transform');\r\n      swapeeChild.style.removeProperty('transform');\r\n      \r\n      // Update positions\r\n      mover.attributes[\"position\"].value = swapeePosition;\r\n      swapee.attributes[\"position\"].value = moverPosition;\r\n\r\n      // Detach listener\r\n      moverChild.removeEventListener('transitionend', handleTransitionEnd);\r\n\r\n      // Notify of completion\r\n      that.reorderCompleted.emit();\r\n    }\r\n\r\n  } \r\n\r\n\r\n\r\n  componentWillLoad() {\r\n    // Set up ids for this instance and its child yeti-reorderees. Set position and reorderees attributes for children.\r\n    let reorderees = this.el.querySelectorAll(\"yeti-reorderee\");\r\n    let myId = (this.el.id) ? this.el.id : utils.generateUniqueId();\r\n\r\n    if (typeof reorderees == 'undefined' || !reorderees.length || reorderees.length < 1) {\r\n      console.warn(\"yeti-reorderer should contain at least one yeti-reorderee element.\");\r\n      return;\r\n    }\r\n\r\n    for (let i = 0; i < reorderees.length; i++) {\r\n      reorderees[i].assignedId = reorderees[i].id = `${myId}_reorderee_${i}`;\r\n      reorderees[i].position = i;\r\n      reorderees[i].reorderees = reorderees.length;\r\n    }\r\n\r\n  }\r\n\r\n\r\n\r\n  render() {\r\n\r\n    let wrapperClass = \"yeti-reorderer\";\r\n\r\n    if (this.wrapperClass != '') {\r\n      wrapperClass += ` ${this.wrapperClass}`;\r\n    }\r\n\r\n    return (\r\n\r\n        <ul class={wrapperClass}><slot /></ul>\r\n\r\n    );\r\n  }\r\n\r\n}"],"names":[],"mappings":"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"}