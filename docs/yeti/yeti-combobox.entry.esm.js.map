{"version":3,"file":"yeti-combobox.entry.esm.js","sources":["src/components/yeti-combobox/yeti-combobox.tsx"],"sourcesContent":["import { Component, Watch, Prop, h, State, Event, EventEmitter, Element, Listen, /*Watch*/ } from '@stencil/core';\r\nimport { utils, YetiComboboxOption } from '../../utils/utils';\r\n\r\n@Component({\r\n  tag: 'yeti-combobox',\r\n  shadow: false,\r\n})\r\nexport class YetiCombobox {\r\n\r\n  @Element() el: HTMLElement;\r\n\r\n  /**\r\n   * Fires when the user has made a selection and closed the dropdown (usually by focusing elsewhere).\r\n   */\r\n  @Event({ bubbles: true }) readyToVerifySlow: EventEmitter<CustomEvent>;\r\n\r\n  /**\r\n   * Fires when the user clicks an option or types in the input field.\r\n   */\r\n  @Event({ bubbles: true }) readyToVerifyFast: EventEmitter<CustomEvent>;\r\n\r\n  /**\r\n   * CSS classlist to add to the component's outer wrapper element.\r\n   */\r\n  @Prop({ attribute: 'wrapper-class'}) wrapperCss: string = '';\r\n\r\n  /**\r\n   * Whether the component requires a valid value.\r\n   */\r\n  @Prop() required: boolean = false;\r\n\r\n  /**\r\n   * Token list of left | right and/or above | below that describes the drop-down's visual position relative to the closed state anchor.\r\n   */\r\n  @Prop() menuAlignment: string = \"\";\r\n\r\n  /**\r\n   * Whether the component has a valid value.\r\n   */\r\n  @Prop({\r\n    mutable: true,\r\n    reflect: true\r\n  }) isValid: boolean;\r\n\r\n  /**\r\n   * The component's value.\r\n   */\r\n  @Prop({\r\n    mutable: true,\r\n    reflect: true\r\n  }) value: string = '';\r\n \r\n  @Watch(\"value\")\r\n  handleValueChange() {\r\n    this.updateOptions();\r\n  }\r\n\r\n  /**\r\n   * Text that appears in the closed state/anchor when there are no selections.\r\n   */\r\n  @Prop() placeholder: string = \"- Select -\";\r\n\r\n  /**\r\n   * Array of YetiComboboxOptions that describes the component's internal representation of its options. See utils.js for more detail.\r\n   */\r\n  @State() options: YetiComboboxOption[] = [];\r\n\r\n  /**\r\n   * Whether or not the user has interacted with the component (i.e. focused and blurred).\r\n   */\r\n  @State() isTouched: boolean = false;\r\n\r\n  /**\r\n   * Toggle to re-render the whole component.\r\n   */\r\n  @State() iLoveJSX: boolean = false;\r\n\r\n  /**\r\n   * Whether or not the drop-down is open/visible or not.\r\n   */\r\n  @State() isOpen: boolean = false;\r\n\r\n  /**\r\n   * 0-based index of the currently focused option.\r\n   */\r\n  @State() cursorPosition: number = -1;\r\n\r\n  /**\r\n   * Whether or not to show the optional Clear all selections puck.\r\n   */\r\n  @Prop() showClear: boolean = true;\r\n\r\n  /**\r\n   * Optionally provide an id for the combobox element.\r\n   */\r\n  @Prop({\r\n    mutable: true,\r\n    reflect: true\r\n  }) inputId: string = \"\";\r\n\r\n  /**\r\n   * Optionally provide a form element name.\r\n   */\r\n  @Prop({\r\n    mutable: true,\r\n    reflect: true\r\n  }) inputName: string = \"\";\r\n\r\n  /**\r\n   * Optionally provide the id of a describing element (like an input tip).\r\n   */\r\n  @Prop({ attribute: 'input-describedby'}) inputDescribedBy: string = \"\";\r\n\r\n  /**\r\n   * Use the Lookup style (i.e. swap the caret for a search icon)\r\n   */\r\n  @Prop() isLookup: boolean = false;\r\n\r\n  /**\r\n   * Whether the options list should be filtered by the text input\r\n   */\r\n  @Prop() isFilterable: boolean = false;\r\n\r\n  /**\r\n   * Whether/how changes to the text field value select an option from the list. Possible values are \"manual\" (default) and \"automatic\". Any value other than \"automatic\" will equal manual.\r\n   */\r\n  @Prop({\r\n    mutable: true,\r\n    reflect: true\r\n  }) selectionType?: string = \"manual\";\r\n \r\n  @Watch(\"selectionType\")\r\n  handleSelectionTypeChange() {\r\n    // Make sure selection type is a valid value.\r\n    this.selectionType = (this.selectionType == \"automatic\") ? this.selectionType : \"manual\";\r\n  }\r\n\r\n\r\n  // These will be initialized on component load\r\n  componentId: string;\r\n  buttonId: string;\r\n  dropdownId: string;\r\n\r\n\r\n\r\n  @Listen(\"click\", {\r\n    target: \"body\"\r\n  })\r\n  handleDefocusingClick() {\r\n    if (this.el.querySelectorAll(\":focus\").length == 0 && this.isOpen) {\r\n      this.closeFlyout();\r\n    }\r\n  }\r\n\r\n\r\n\r\n  handleClick(ev) {\r\n    this.isTouched = true;\r\n    this.toggleFlyout();\r\n    ev.preventDefault();\r\n  }\r\n\r\n\r\n\r\n  handleButtonClick(ev) {\r\n    ev.preventDefault();\r\n    // Otherwise just let the handleClick function do the rest.\r\n  }\r\n\r\n\r\n\r\n  @Listen(\"keydown\")\r\n  handleKeydown(ev: KeyboardEvent) {\r\n\r\n    let key = ev.key.toString().toLowerCase();\r\n\r\n    switch (key) {\r\n\r\n      // Handle potential tabout\r\n      case \"tab\": {\r\n\r\n        // Normal tab direction\r\n        if (!ev.shiftKey) {\r\n\r\n          if (this.el.querySelectorAll(\".yeti-combobox-input:focus\").length == 0 || this.value == \"\") {\r\n            this.closeFlyout();\r\n          }\r\n\r\n        // Shift tab direction (backwards)\r\n        } else {\r\n\r\n          if (this.el.querySelectorAll(\".yeti-combobox-input:focus\").length > 0) {\r\n            this.closeFlyout();\r\n          }\r\n\r\n        }\r\n        \r\n        break;\r\n      }\r\n\r\n\r\n      // Handle arrow navigation\r\n      case \"arrowdown\": {\r\n\r\n        if (this.isOpen) {\r\n          this.cursorPosition = (this.cursorPosition + 1) % this.options.length;\r\n          ev.preventDefault();\r\n        } else {\r\n\r\n          this.cursorPosition = (ev.altKey) ? this.cursorPosition : 0;\r\n          this.openFlyout();\r\n          ev.preventDefault();\r\n\r\n        }\r\n\r\n        break;\r\n      }\r\n\r\n\r\n      // Handle arrow navigation\r\n      case \"arrowup\": {\r\n\r\n        if (this.isOpen) {\r\n          this.cursorPosition = (this.cursorPosition - 1 + this.options.length) % this.options.length;\r\n          ev.preventDefault();\r\n        } else {\r\n\r\n          this.cursorPosition = this.options.length - 1;\r\n          this.openFlyout();\r\n          ev.preventDefault();\r\n\r\n        }\r\n\r\n        break;\r\n      }\r\n\r\n\r\n      // Handle escape navigation\r\n      case \"escape\": {\r\n\r\n        if (this.isOpen) {\r\n          this.closeFlyout();\r\n          ev.preventDefault();\r\n        }\r\n\r\n        break;\r\n      }\r\n\r\n\r\n      // Handle dropdown open/close toggling enter/space or selection-making enter/space\r\n      case \"enter\": {\r\n\r\n        // Check to see if this happened while selecting something.\r\n        ev.preventDefault();\r\n        let target = ev.target as HTMLElement;\r\n\r\n        // First check if the clear everything puck has focus\r\n        if (target.classList.contains(\"yeti-combobox-clear\")) {\r\n          target.click();\r\n          break;\r\n        } \r\n        \r\n        else {\r\n          \r\n          // Next check if the cursor is on a selection and the flyout is open\r\n          if (this.cursorPosition >= 0 && this.isOpen) {\r\n            // Toggle selection on the option at this cursor position.\r\n            this.handleOptionClick(this.cursorPosition);\r\n          }\r\n          \r\n          // Finally, if the selection type is automatic, and there's at least one option selected, set the value to its label.\r\n          if (this.selectionType == \"automatic\") {\r\n            for (let option of this.options) {\r\n              if (option.selected) {\r\n                this.value = option.label;\r\n                break;\r\n              }\r\n            }\r\n          }\r\n          \r\n          this.closeFlyout();\r\n        }\r\n\r\n        break;\r\n      }\r\n      \r\n      default: {\r\n        // If the user is trying to type a letter or number then open the flyout\r\n        if (key.length == 1 && key.match(/[a-zA-Z0-9]/)) {\r\n          this.openFlyout();\r\n        }\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n\r\n\r\n  handleClearSelections(ev: Event) {\r\n    let fieldElement = this.el.querySelector(\".yeti-combobox-input\") as HTMLElement;\r\n    for (let option of this.options) {\r\n      option.selected = false;\r\n    }\r\n    this.value = \"\";\r\n    fieldElement.focus();\r\n    ev.stopPropagation();\r\n    this.readyToVerifySlow.emit();\r\n    this.readyToVerifyFast.emit();\r\n  }\r\n\r\n\r\n\r\n  handleInputChange(ev) {\r\n    this.value = ev.target.value;\r\n  }\r\n\r\n\r\n\r\n  updateOptions() {\r\n    // Based on the (new) value of this.value, set the options' status\r\n    let foundASelectionAlready = false;\r\n\r\n    for (let option of this.options) {\r\n      option.selected = (option.label.toLowerCase() == this.value.toLowerCase());\r\n\r\n      // Determine whether to show this option or not based on filtering\r\n      if (this.isFilterable && option.label.toLowerCase().indexOf( this.value.toLowerCase() ) < 0) {\r\n        option.isVisible = false;\r\n      } else {\r\n        option.isVisible = true;\r\n      }\r\n\r\n      // Determine whether to mark this option as selected based on selection type\r\n      if (this.selectionType == \"automatic\") {\r\n\r\n        // If this is a match, and we don't already have one, mark this one as selected. Otherwise set it as unselected.\r\n        if (!foundASelectionAlready\r\n            && this.value != \"\"\r\n            && option.label.toLowerCase().indexOf( this.value.toLowerCase() ) >= 0 \r\n        ) {\r\n          option.selected = true;\r\n          foundASelectionAlready = true;\r\n        } else {\r\n          option.selected = false;\r\n        }\r\n\r\n      }\r\n      \r\n    }\r\n\r\n  }\r\n\r\n\r\n\r\n  openFlyout() {\r\n    this.isOpen = true;\r\n  }\r\n\r\n\r\n\r\n  closeFlyout() {\r\n    this.isOpen = false;\r\n    // this.cursorPosition = -1;\r\n    this.isTouched = true;\r\n    this.readyToVerifySlow.emit();\r\n  }\r\n\r\n\r\n\r\n  toggleFlyout() {\r\n    if (this.isOpen) {\r\n      this.closeFlyout()\r\n    } else {\r\n      this.openFlyout();\r\n    }\r\n  }\r\n\r\n\r\n\r\n  handleFieldBlur(ev) {\r\n    this.isTouched = true;\r\n    \r\n    // If selection type is automatic, update value with the first selected option.\r\n    if (this.selectionType == \"automatic\") {\r\n      for (let option of this.options) {\r\n        if (option.selected) {\r\n          this.value = option.label;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    this.readyToVerifySlow.emit(ev);\r\n  }\r\n\r\n\r\n\r\n  parseOptionElements(options: HTMLCollection) {\r\n\r\n    for (let i = 0; i < options.length; i++) {\r\n      \r\n      let option = options.item(i);\r\n      \r\n      // First, confirm this element is indeed a yeti-combobox-option element.\r\n      if (option.tagName.toLowerCase() == 'yeti-combobox-option') {\r\n\r\n        let optionId;\r\n\r\n        if (option.hasAttribute(\"id\")) {\r\n          optionId = option.getAttribute(\"id\");\r\n        } else {\r\n          optionId = `${this.el.getAttribute(\"id\")}_option${i}`;\r\n        }\r\n\r\n        this.options.push({\r\n          selected: (option.hasAttribute(\"selected\") || option.innerHTML == this.value),\r\n          label: option.innerHTML,\r\n          isVisible: true,\r\n          id: optionId\r\n        });\r\n\r\n        if (option.hasAttribute(\"selected\")) {\r\n          this.value = option.innerHTML;\r\n        }\r\n\r\n      }\r\n\r\n    } // End for\r\n\r\n    // Finally, we need to remove the option elements.\r\n    for (let j = options.length - 1; j >= 0; --j) {\r\n      options.item(j).remove();\r\n    }\r\n\r\n  }\r\n\r\n\r\n\r\n  getPlaceholderDisplay() {\r\n    // Returns the string of text that should go in the placeholder area.\r\n    return (this.value != \"\") ? this.value : this.placeholder;\r\n  }\r\n\r\n\r\n\r\n  handleOptionClick(i: number) {\r\n    // i = options index\r\n    let clickedOption = this.options[i];\r\n    let input = this.el.querySelector(\".yeti-combobox-input\") as HTMLInputElement;\r\n\r\n    // Set selected state of each option\r\n    for (let j = 0; j < this.options.length; j++) {\r\n      this.options[j].selected = (i == j);\r\n    }\r\n\r\n    // Update value, close dropdown, refocus, and fire events\r\n    this.value = clickedOption.label;\r\n    this.closeFlyout();\r\n    input.focus();\r\n    this.readyToVerifyFast.emit();\r\n  }\r\n\r\n\r\n\r\n  componentWillLoad() {\r\n    // Set up ids and handle any <yeti-combobox-option> elements\r\n    let optionElements = this.el.children;\r\n\r\n    // Set up ids\r\n    this.componentId = this.el.getAttribute(\"id\");\r\n\r\n    if (!this.componentId || this.componentId == \"\") {\r\n      this.componentId = utils.generateUniqueId();\r\n      this.el.setAttribute(\"id\", this.componentId);\r\n    }\r\n\r\n    this.inputId = (this.inputId != \"\") ? this.inputId : this.componentId + \"_input\";\r\n    this.buttonId = this.componentId + \"_button\";\r\n    this.dropdownId = this.componentId + \"_dropdown\";\r\n\r\n    this.inputName = (this.inputName != \"\") ? this.inputName : this.inputId; // If the user supplied a name, use it, otherwise just re-use the id.\r\n\r\n    // Look for and handle any <yeti-combobox-option> elements.\r\n    if (optionElements.length > 0) {\r\n      this.parseOptionElements(optionElements);\r\n    }\r\n\r\n    // Make sure selection type is a valid value.\r\n    this.selectionType = (this.selectionType == \"automatic\") ? this.selectionType : \"manual\";\r\n  }\r\n\r\n\r\n\r\n  render() {\r\n\r\n    let wrapperCss = 'yeti-combobox-wrapper';\r\n    let dropdownCss = 'yeti-combobox-dropdown';\r\n    let activeDescendantId = (this.isOpen && this.cursorPosition != -1) ? `${this.componentId}_option${this.cursorPosition}` : ``; // If there is an active descendant (i.e. the menu is open and one of the options has the cursor highlight) then its id will look something like componentId_option3.\r\n\r\n    wrapperCss += (this.wrapperCss == \"\") ? '' : ` ${this.wrapperCss}`;\r\n\r\n    if (this.isValid == false) {\r\n      wrapperCss += ' yeti-combobox__error';\r\n    }\r\n\r\n    dropdownCss += (this.isOpen) ? \" yeti-combobox-dropdown__open\" : \"\";\r\n\r\n    if (this.menuAlignment == \"right\") {\r\n      dropdownCss += ' yeti-combobox-dropdown-align-right'\r\n    }\r\n\r\n    return ([\r\n      <div class={wrapperCss}>\r\n\r\n        <div \r\n          class=\"yeti-combobox\"\r\n          onClick={(ev) => this.handleClick(ev)}\r\n        >\r\n\r\n          <input \r\n            type=\"text\" \r\n            class=\"yeti-combobox-input\" \r\n            // title={this.value}\r\n            value={this.value}\r\n            name={this.inputName}\r\n            onFocus={() => {\r\n              this.isTouched = true;\r\n            }}\r\n            onBlur={(e) => {\r\n              this.handleFieldBlur(e);\r\n            }}\r\n            onInput={(ev) => this.handleInputChange(ev)}\r\n            role=\"combobox\"\r\n            autocomplete=\"off\"\r\n            aria-autocomplete=\"none\"\r\n            aria-controls={this.dropdownId}\r\n            aria-expanded={this.isOpen}\r\n            id={this.inputId}\r\n            {...(this.inputDescribedBy != \"\") ? { \"aria-describedby\" : this.inputDescribedBy } : {}}\r\n            {...(activeDescendantId != \"\") ? { \"aria-activedescendant\" : activeDescendantId } : {}}\r\n          />\r\n\r\n          { (this.showClear && this.value != '') ? \r\n\r\n            (<button class=\"yeti-combobox-clear\" title=\"Clear all selections\" onClick={ (ev) => { this.handleClearSelections(ev); ev.preventDefault() }}>\r\n              <span class=\"material-icons yeti-combobox-clear-icon\" aria-hidden=\"true\">clear</span>\r\n            </button>)\r\n\r\n          :\r\n\r\n            \"\"\r\n\r\n          }\r\n\r\n          <button \r\n            class=\"yeti-combobox-button\" \r\n            tabIndex={-1}\r\n            aria-controls={this.dropdownId}\r\n            aria-expanded={this.isOpen}\r\n            id={this.buttonId}\r\n            onClick={(ev) => { this.handleButtonClick(ev) }}\r\n          >\r\n            {\r\n              (!this.isLookup) ?\r\n\r\n                <yeti-icon iconCode={(this.isOpen ? 'expand_less' : 'expand_more')} alt={(this.isOpen ? 'close' : 'open')}></yeti-icon>\r\n\r\n              :\r\n\r\n                <yeti-icon iconCode='search' alt={(this.isOpen ? 'lookup, close' : 'lookup, open')}></yeti-icon>\r\n\r\n            }\r\n            \r\n          </button>\r\n\r\n        </div>\r\n\r\n        \r\n        <div class={dropdownCss}>\r\n        \r\n          <ul\r\n            class=\"yeti-combobox-options\"\r\n            id={this.dropdownId}\r\n            role=\"listbox\"\r\n          >\r\n\r\n            {this.options.map((option, i) => {\r\n\r\n                let optionClass = (this.cursorPosition == i) ? \"yeti-combobox-option yeti-combobox-option__hover\" : \"yeti-combobox-option\";\r\n                optionClass += (option.selected) ? \" yeti-combobox-option__selected\" : \"\";\r\n\r\n                // Only render visible options\r\n                if (!option.isVisible) {\r\n                  return \"\";\r\n                }\r\n              \r\n                return (\r\n                  <li \r\n                    id={option.id} \r\n                    key={option.id} \r\n                    role=\"option\"\r\n                    aria-selected={`${option.selected}`}\r\n                    class={optionClass}\r\n                    onClick={(ev) => { this.handleOptionClick(i); ev.preventDefault(); }}\r\n                  >\r\n\r\n                      <span class=\"yeti-combobox-option-label\">{option.label}</span>\r\n                      <span class=\"yeti-combobox-option-checkmark\" aria-hidden='true'>\r\n                        {(option.selected) ? \r\n                        \r\n                          <yeti-icon iconCode='checkmark'></yeti-icon>\r\n\r\n                        :\r\n\r\n                          ''\r\n\r\n                        }\r\n                      </span>\r\n\r\n                  </li>\r\n                )\r\n              }\r\n            \r\n            )}\r\n\r\n          </ul>\r\n\r\n        </div>\r\n\r\n      </div>\r\n    ]);\r\n  }\r\n\r\n\r\n\r\n  componentDidRender() {\r\n    // If the cursor is over an option, make sure it's visible.\r\n    if (this.isOpen) {\r\n      // The facade dropdown is open. If one of the options is being hovered over then we want to scroll it into view.\r\n      // If not, then we'll scroll the whole dropdown into view.\r\n      let dropdown = this.el.querySelector(\".yeti-combobox-dropdown\");\r\n      let hoveredOption = this.el.querySelector(\".yeti-combobox-option__hover\");\r\n      let thingToScrollIntoView = (hoveredOption) ? hoveredOption : dropdown;\r\n      thingToScrollIntoView.scrollIntoView({\r\n        behavior: \"smooth\",\r\n        block: \"nearest\"\r\n      });\r\n    }\r\n  }\r\n\r\n}"],"names":[],"mappings":"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"}