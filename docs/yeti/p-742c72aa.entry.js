import{r as t,c as i,h as s,g as e}from"./p-ad659053.js";import{u as h}from"./p-5f7a1b51.js";const l=class{constructor(s){t(this,s),this.menuButtonChange=i(this,"menuButtonChange",7),this.menuButtonSelectionMade=i(this,"menuButtonSelectionMade",7),this.justMadeASelection=!1,this.hasCustomButtonContents=!1,this.wrapperCSS="",this.buttonCSS="",this.menuCSS="",this.buttonId="",this.buttonType="",this.menuId="",this.tooltipText="Options",this.menuAlignment="",this.hasTooltip=!0,this.value="",this.labelledBy="",this.describedBy="",this.options=[],this.isTouched=!1,this.iLoveJSX=!1,this.isOpen=!1,this.cursorPosition=-1}handleValueChange(t,i){this.menuButtonChange.emit({newValue:t,oldValue:i})}handleDefocusingClick(){0==this.el.querySelectorAll(":focus").length&&this.isOpen&&this.closeMenu()}handleKeydown(t){switch(t.key.toString().toLowerCase()){case"tab":this.closeMenu();break;case"arrowdown":this.isOpen?this.cursorPosition=(this.cursorPosition+1)%this.options.length:(this.cursorPosition=0,this.openMenu()),t.preventDefault();break;case"arrowup":this.isOpen?this.cursorPosition=(this.cursorPosition-1+this.options.length)%this.options.length:(this.cursorPosition=this.options.length-1,this.openMenu()),t.preventDefault();break;case" ":this.isOpen||(this.cursorPosition=0,this.openMenu()),t.preventDefault();break;case"enter":this.isOpen?(this.value=this.options[this.cursorPosition].label,this.justMadeASelection=!0,this.closeMenu()):(this.openMenu(),this.cursorPosition=0,t.preventDefault());break;case"home":this.isOpen&&(this.cursorPosition=0),t.preventDefault();break;case"end":this.isOpen&&(this.cursorPosition=this.options.length-1),t.preventDefault()}}openMenu(){this.isOpen=!0}closeMenu(){this.isOpen=!1,this.cursorPosition=-1,this.isTouched=!0}toggleMenu(){this.isOpen?this.closeMenu():this.openMenu()}parseChildTags(){let t=this.el.querySelectorAll("yeti-menu-button-option"),i=this.el.querySelector("yeti-menu-button-contents");this.options=t&&t.length&&t.length>0?[]:this.options;for(let i=0;i<t.length;i++){let s=t.item(i);if("yeti-menu-button-option"==s.tagName.toLowerCase()){let t={label:"",id:"",href:"",value:"",hasHTML:!1},e=s.getAttribute("id");if(t.id=e&&""!=e?e:`${this.el.getAttribute("id")}_option${i}`,t.label=s.innerText.trim().replace(/\t/g,""),t.label=t.label.replace(/\n/g," "),s.hasAttribute("href")&&""!=s.getAttribute("href")&&(t.href=s.getAttribute("href")),1!=s.childNodes.length||3!=s.firstChild.nodeType){t.hasHTML=!0;let i=document.createElement("div");for(i.setAttribute("slot",t.id);s.childNodes.length>0;)i.appendChild(s.childNodes[0]);this.el.appendChild(i),t.innerHTML=s.innerHTML}this.options.push(t)}}i&&(this.hasCustomButtonContents=!0,i.setAttribute("slot","buttonContents"));for(let i=t.length-1;i>=0;--i)t.item(i).remove()}unwrapButtonContents(){let t=this.el.querySelector("yeti-menu-button-contents");t&&t.replaceWith(...Array.from(t.childNodes))}renderMenuItems(){let t=[];for(let i=0;i<this.options.length;i++){let e,h,l=this.options[i],n=`${l.id}`;e=l.href?s("a",{href:l.href,class:"yeti-menu_button-menu-item-link",role:"menuitem",tabindex:"-1","data-option-index":i,onClick:t=>{this.handleOptionClick(i,t,!0)}},l.hasHTML?s("slot",{name:l.id}):l.label):s("button",{class:"yeti-menu_button-menu-item-button",role:"menuitem",tabindex:"-1","data-option-index":i,onClick:t=>{this.handleOptionClick(i,t)}},l.hasHTML?s("slot",{name:l.id}):l.label),h=s("li",{class:"yeti-menu_button-menu-item",role:"presentation",id:n,key:n},e),t.push(h)}return t}handleOptionClick(t,i,s=!1){this.value=this.options[t].label,this.justMadeASelection=!0,this.closeMenu(),s||i.preventDefault()}handleActualFocus(){let t=this.el.querySelector(".yeti-multiselect");t&&t.focus()}handleButtonClick(t){this.isOpen=!this.isOpen,t.preventDefault()}renderButton(t){return s("button",Object.assign({class:t,"aria-haspopup":"true"},this.isOpen?{"aria-expanded":"true"}:{},{"aria-controls":this.menuId,id:this.buttonId,role:"button",onClick:t=>{this.handleButtonClick(t)}}),this.hasCustomButtonContents?s("slot",{name:"buttonContents"}):[s("span",{class:"material-icons","aria-hidden":"true"},"more_vert"),s("span",{class:"yeti-a11y-hidden"},"Options")])}componentWillLoad(){let t=this.el.getAttribute("id");t&&""!=t||this.el.setAttribute("id",h.generateUniqueId()),this.buttonId=""!=this.buttonId?this.buttonId:`${t}_button`,this.menuId=""!=this.menuId?this.menuId:`${t}_menu`}componentWillRender(){this.parseChildTags()}componentDidRender(){this.unwrapButtonContents();let t=this.el.querySelector('[data-option-index="'+this.cursorPosition+'"'),i=this.el.querySelector(".yeti-menu_button-menu");if(t&&t.focus(),this.isOpen&&i.scrollIntoView({behavior:"smooth",block:"nearest"}),this.justMadeASelection){let t=this.el.querySelector(".yeti-menu_button-button");t&&(t.focus(),t.scrollIntoView({behavior:"smooth",block:"nearest"})),this.menuButtonSelectionMade.emit({value:this.value}),this.justMadeASelection=!1}}render(){let t="yeti-menu_button",i="yeti-menu_button-button",e="yeti-menu_button-menu",h=`${this.el.getAttribute("id")}_tooltip`;return this.menuAlignment.indexOf("right")>-1&&(t+=" yeti-menu_button-right_aligned"),this.isOpen&&(t+=" yeti-menu_button__open"),this.buttonType&&""!=this.buttonType&&(i=`${i} yeti-menu_button-button-mimic ${i}-${this.buttonType}`),t+=this.wrapperCSS&&""!=this.wrapperCSS?" "+this.wrapperCSS:"",i+=this.buttonCSS&&""!=this.buttonCSS?" "+this.buttonCSS:"",e+=this.menuCSS&&""!=this.menuCSS?" "+this.menuCSS:"",[s("div",{class:t},this.hasTooltip?s("yeti-tooltip",{text:this.tooltipText,id:h,slotId:this.buttonId,tipId:`${this.buttonId}_tooltip`},this.renderButton(i)):this.renderButton(i),s("ul",{class:e,role:"menu",id:this.menuId,"aria-labelledby":this.buttonId,key:this.menuId},this.renderMenuItems()))]}get el(){return e(this)}static get watchers(){return{value:["handleValueChange"]}}},n=class{constructor(s){t(this,s),this.readyToVerifySlow=i(this,"readyToVerifySlow",7),this.readyToVerifyFast=i(this,"readyToVerifyFast",7),this.cssClass="",this.facadeId="",this.actualId="",this.actualName=this.actualId,this.required=!1,this.menuAlignment="",this.isValid=void 0,this.value="",this.labelledBy="",this.describedBy="",this.placeholder="- Select -",this.showClear=!0,this.options=[],this.isTouched=!1,this.numSelections=0,this.iLoveJSX=!1,this.isOpen=!1,this.cursorPosition=-1}handleDefocusingClick(){0==this.el.querySelectorAll(":focus").length&&this.isOpen&&this.closeFlyout()}handleKeydown(t){switch(t.key.toString().toLowerCase()){case"tab":t.shiftKey?this.el.querySelectorAll(".yeti-multiselect:focus").length>0&&this.closeFlyout():0==this.el.querySelectorAll(".yeti-multiselect:focus").length&&this.closeFlyout();break;case"arrowdown":this.isOpen?(this.cursorPosition=(this.cursorPosition+1)%this.options.length,t.preventDefault()):t.altKey&&(this.openFlyout(),t.preventDefault());break;case"arrowup":this.isOpen?(this.cursorPosition=(this.cursorPosition-1+this.options.length)%this.options.length,t.preventDefault()):t.altKey&&(this.openFlyout(),t.preventDefault());break;case"escape":this.isOpen&&(this.closeFlyout(),t.preventDefault());break;case"enter":case" ":{t.preventDefault();let i=t.target;if(i.classList.contains("yeti-multiselect-puck")){i.click();break}this.cursorPosition>=0?this.handleOptionClick(this.cursorPosition):this.toggleFlyout();break}}}openFlyout(){this.isOpen=!0}closeFlyout(){this.isOpen=!1,this.cursorPosition=-1,this.isTouched=!0,this.readyToVerifySlow.emit()}toggleFlyout(){this.isOpen?this.closeFlyout():this.openFlyout()}handleFieldBlur(t){this.isTouched=!0,this.readyToVerifySlow.emit(t)}parseOptionElements(t){for(let i=0;i<t.length;i++){let s=t.item(i);if("yeti-multiselect-option"==s.tagName.toLowerCase()){let t;t=s.hasAttribute("id")?s.getAttribute("id"):`${this.el.getAttribute("id")}_option${i}`,this.options.push({selected:s.hasAttribute("selected"),label:s.innerHTML,id:t}),s.hasAttribute("selected")&&++this.numSelections}}for(let i=t.length-1;i>=0;--i)t.item(i).remove()}getPlaceholderDisplay(){switch(this.numSelections){case 0:return this.placeholder;case 1:for(let t=0;t<this.options.length;t++)if(this.options[t].selected)return this.options[t].label;default:return`${this.numSelections} selections`}}renderActualOptions(){let t=[];for(let i=0;i<this.options.length;i++){let e=s("option",{value:this.options[i].label,selected:this.options[i].selected},this.options[i].label);t.push(e)}return t}handleOptionClick(t){let i=[];this.numSelections=this.options[t].selected?--this.numSelections:++this.numSelections,this.options[t].selected=!this.options[t].selected;for(let t=0;t<this.options.length;t++)this.options[t].selected&&i.push(this.options[t].label);this.value=i.toString(),this.iLoveJSX=!this.iLoveJSX,this.readyToVerifyFast.emit()}handleClearSelections(t){let i=this.el.querySelector(".yeti-multiselect");for(let t=0;t<this.options.length;t++)this.options[t].selected=!1;this.value="",this.numSelections=0,i.focus(),t.stopPropagation(),this.readyToVerifySlow.emit(),this.readyToVerifyFast.emit()}handleActualFocus(){let t=this.el.querySelector(".yeti-multiselect");t&&t.focus()}componentWillLoad(){let t=this.el.children,i=this.el.getAttribute("id");i&&""!=i||(i=h.generateUniqueId(),this.el.setAttribute("id",i)),this.actualId=""!=this.actualId?this.actualId:`${i}_actual`,this.actualName=this.actualId,this.facadeId=""!=this.facadeId?this.facadeId:`${i}_facade`,this.el.hasAttribute("id")&&""!=this.el.getAttribute("id")?this.el.getAttribute("id"):this.el.setAttribute("id",h.generateUniqueId()),t.length>0&&this.parseOptionElements(t)}componentWillRender(){if(""==this.value){for(let t=0;t<this.options.length;t++)this.options[t].selected=!1;this.value="",this.numSelections=0}}componentDidRender(){if(this.isOpen){let t=this.el.querySelector(".yeti-multiselect-flyout");(this.el.querySelector(".yeti-multiselect-option__hover")||t).scrollIntoView({behavior:"smooth",block:"nearest"})}}render(){let t="yeti-multiselect",i="yeti-multiselect-flyout";return""!=this.cssClass&&(t+=" "+this.cssClass),0==this.isValid&&(t+=" yeti-multiselect__error"),i+=this.isOpen?" yeti-multiselect-flyout__open":"","right"==this.menuAlignment&&(i+=" yeti-multiselect-flyout-align-right"),[s("div",{class:"yeti-multiselect-wrapper"},s("select",Object.assign({tabIndex:-1,class:"yeti-multiselect-actual yeti-a11y-hidden",multiple:!0,id:this.actualId,name:this.actualName,onFocus:()=>{this.handleActualFocus()}},this.isValid?{}:{"aria-invalid":!0},""!=this.labelledBy?{"aria-labelledby":this.labelledBy}:{},""!=this.describedBy?{"aria-describedby":this.describedBy}:{}),this.renderActualOptions()),s("div",{tabIndex:0,class:t,onClick:()=>{this.isOpen=!this.isOpen},onFocus:()=>{this.isTouched=!0},"aria-hidden":"true"},s("span",{class:"yeti-multiselect-placeholder",title:this.getPlaceholderDisplay()},this.getPlaceholderDisplay()),this.showClear&&this.numSelections>0?s("button",{class:"yeti-multiselect-puck",title:"Clear all selections",onClick:t=>{this.handleClearSelections(t),t.preventDefault()}},s("span",{class:"material-icons yeti-multiselect-puck-icon","aria-hidden":"true"},"cancel")):""),s("div",{class:i,"aria-hidden":"true"},s("ul",{class:"yeti-multiselect-options",id:this.facadeId},this.options.map(((t,i)=>s("li",{id:t.id,key:t.id},s("button",{class:this.cursorPosition==i?"yeti-multiselect-option yeti-multiselect-option__hover":"yeti-multiselect-option",tabIndex:-1,onClick:t=>{this.handleOptionClick(i),t.preventDefault()}},s("span",{class:"yeti-multiselect-option-checkbox"},s("span",{class:"material-icons"},t.selected?"check_box":"check_box_outline_blank")),s("span",{class:"yeti-multiselect-option-label"},t.label))))))))]}get el(){return e(this)}};export{l as yeti_menu_button,n as yeti_multiselect}