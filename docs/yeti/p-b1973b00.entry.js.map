{"version":3,"names":["YetiDropdown","this","searchId","utils","generateUniqueId","didJustOpen","handleOptionsChange","runningInitialValueArray","alreadyFoundASelectedOption","newNumSelections","i","options","length","option","id","el","getAttribute","value","label","isMultiselect","selected","push","toString","numSelections","handleIsOpenChange","newValue","handleDefocusingClick","querySelectorAll","isOpen","closeFlyout","handleKeyup","ev","key","toLowerCase","dropdownElement","querySelector","setTimeout","contains","document","activeElement","focus","cursorPosition","getNextVisibleCursorPosition","preventDefault","altKey","openFlyout","getPreviousVisibleCursorPosition","target","classList","click","console","log","handleOptionClick","toggleFlyout","handleSearchInputClear","resetAllOptionsVisibility","searchString","numOptions","safeCursorPosition","isVisible","isTouched","readyToVerifySlow","emit","handleFieldBlur","parseOptionElements","item","tagName","optionId","selectedState","optionValue","hasAttribute","textContent","j","remove","getPlaceholderDisplay","placeholder","readyToVerifyFast","handleClearSelections","fieldElement","stopPropagation","handleSearchKeyUp","searchField","isSearchable","stopImmediatePropagation","_b","_a","indexOf","componentWillLoad","optionElements","children","componentId","setAttribute","comboboxId","formName","flyoutId","componentDidRender","flyout","hoveredOption","thingToScrollIntoView","scrollIntoView","behavior","block","render","comboboxClasses","flyoutClass","wrapperClass","isValid","menuAlignment","h","class","Object","assign","tabIndex","onClick","onFocus","role","labelledBy","describedBy","title","showClear","onKeyUp","e","inputId","autocomplete","map","optionClass","iconCode","iconClass","YetiMenuButton","justMadeASelection","hasCustomButtonContents","handleValueChange","oldValue","menuButtonChange","closeMenu","handleKeydown","openMenu","toggleMenu","parseChildTags","buttonLabel","optionObject","href","hasHTML","innerText","trim","replace","downloadAs","childNodes","firstChild","nodeType","div","createElement","appendChild","innerHTML","unwrapButtonContents","wrapper","replaceWith","Array","from","renderMenuItems","items","linkOrButtonElement","listItemId","download","tabindex","name","type","isLink","handleActualFocus","facade","handleButtonClick","renderButton","buttonClass","menuId","buttonId","elementId","componentWillRender","selector","menu","button","menuButtonSelectionMade","menuClass","tooltipId","buttonType","text","tooltipText","slotId","tipId"],"sources":["src/components/yeti-dropdown/yeti-dropdown.tsx","src/components/yeti-menu-button/yeti-menu-button.tsx"],"sourcesContent":["import { Component, Prop, h, State, Event, EventEmitter, Element, Listen, Watch } from '@stencil/core';\r\nimport { utils, YetiDropdownOption } from '../../utils/utils';\r\n\r\n@Component({\r\n  tag: 'yeti-dropdown',\r\n  shadow: false,\r\n})\r\nexport class YetiDropdown {\r\n\r\n  @Element() el: HTMLElement;\r\n\r\n  /**\r\n   * Fires when the user has made a selection and closed the dropdown (usually by focusing elsewhere).\r\n   */\r\n  @Event({ bubbles: true }) readyToVerifySlow: EventEmitter<CustomEvent>;\r\n\r\n  /**\r\n   * Fires when the user toggles any of the options.\r\n   */\r\n  @Event({ bubbles: true }) readyToVerifyFast: EventEmitter<CustomEvent>;\r\n\r\n  /**\r\n   * CSS classlist to add to the component's outer wrapper element.\r\n   */\r\n  @Prop() wrapperClass: string = '';\r\n\r\n  /**\r\n   * id of the root html element.\r\n   */\r\n  @Prop({\r\n    attribute: \"html-id\",\r\n    mutable: true,\r\n    reflect: true\r\n  }) comboboxId: string = \"\"; // Will be initialized on load (if necessary).\r\n\r\n  /**\r\n   * id of the drop-down element.\r\n   */\r\n  @Prop({\r\n    mutable: true,\r\n    reflect: true\r\n  }) flyoutId: string = \"\"; // Will be initialized on load (if necessary).\r\n\r\n  /**\r\n   * form's name for the actual drop-down element. Defaults to match id.\r\n   */\r\n  @Prop({\r\n    mutable: true,\r\n    reflect: true\r\n  }) formName: string = \"\"; // Will be initialized on load (if necessary).\r\n\r\n  /**\r\n   * Whether the component requires a valid value.\r\n   */\r\n  @Prop() required: boolean = false;\r\n\r\n  /**\r\n   * Whether the component is a Multiselect variant or not (defaults to not).\r\n   */\r\n  @Prop() isMultiselect: boolean = false;\r\n\r\n  /**\r\n   * Token list of left | right and/or above | below that describes the drop-down's visual position relative to the closed state anchor.\r\n   */\r\n  @Prop() menuAlignment: string = \"\";\r\n\r\n  /**\r\n   * Whether the component has a valid value.\r\n   */\r\n  @Prop({\r\n    mutable: true,\r\n    reflect: true\r\n  }) isValid: boolean = true;\r\n\r\n  /**\r\n   * The component's value is represented as a string of comma-separated values.\r\n   */\r\n  @Prop({\r\n    mutable: true,\r\n    reflect: true\r\n  }) value: string = '';\r\n\r\n  /**** TODO: handle programmatic value changes: i.e. when controller JS sets [component].value \r\n  @Watch(\"value\")\r\n  handleValueChange(newValue: string, oldValue: string) {\r\n    this.handleProgrammaticValueChange(newValue, oldValue);\r\n  }*/\r\n\r\n  /**\r\n   * id of an external HTML element that the component's actual drop-down element references in aria-labelledby.\r\n   */\r\n  @Prop() labelledBy: string = \"\";\r\n\r\n  /**\r\n   * id of an external HTML element that the component's actual drop-down element references in aria-describedby.\r\n   */\r\n  @Prop() describedBy: string = \"\";\r\n\r\n  /**\r\n   * Text that appears in the closed state/anchor when there are no selections.\r\n   */\r\n  @Prop() placeholder: string = \"- Select -\";\r\n\r\n  /**\r\n   * Whether or not to show the optional Clear all selections puck.\r\n   */\r\n  @Prop() showClear: boolean = true;\r\n\r\n  /**\r\n   * Whether or not the user can filter the options by searching for a specific string.\r\n   */\r\n  @Prop() isSearchable: boolean = false;\r\n\r\n  /**\r\n   * A string to filter options against. Empty doesn't filter anything.\r\n   */\r\n  @Prop({\r\n    mutable: true,\r\n    reflect: true\r\n  }) searchString: string = \"\";\r\n\r\n  /**\r\n   * Array of YetiDropdownOptions that describes the component's internal representation of its options. See utils.js for more detail.\r\n   */\r\n  @Prop({mutable: true}) options: YetiDropdownOption[] = [];\r\n  @Watch(\"options\")\r\n  handleOptionsChange() {\r\n\r\n    let runningInitialValueArray = [];\r\n    let alreadyFoundASelectedOption = false;\r\n    let newNumSelections = 0;\r\n\r\n    for (let i = 0; i < this.options.length; i++) {\r\n\r\n      let option = this.options[i];\r\n\r\n      // Set id\r\n      option.id = (option.id) ? option.id : `${this.el.getAttribute(\"id\")}_option${i}`;\r\n\r\n      // Set value\r\n      option.value = option.value ? option.value : option.label;\r\n\r\n      // Handle selected attribute\r\n      if (!this.isMultiselect) {\r\n        if (option.selected) {\r\n          option.selected = !alreadyFoundASelectedOption;\r\n        }\r\n        \r\n        if (option.selected) {\r\n          alreadyFoundASelectedOption = true;\r\n        }\r\n      }\r\n\r\n      if (option.selected) {\r\n        ++newNumSelections;\r\n        runningInitialValueArray.push(option.value);\r\n      }\r\n        \r\n\r\n    } // End for\r\n\r\n    // Initialize value and numSelections\r\n    this.value = runningInitialValueArray.toString();\r\n    this.numSelections = newNumSelections;\r\n\r\n  }\r\n\r\n  /**\r\n   * Whether or not the user has interacted with the component (i.e. focused and blurred).\r\n   */\r\n  @State() isTouched: boolean = false;\r\n\r\n  /**\r\n   * Number of total selections (used primarily for the anchor).\r\n   */\r\n  @State() numSelections: number = 0;\r\n\r\n  /**\r\n   * Whether or not the drop-down is open/visible or not.\r\n   */\r\n  @State() isOpen: boolean = false;\r\n  @Watch(\"isOpen\")\r\n  handleIsOpenChange(newValue) {\r\n    if (newValue) {\r\n      this.didJustOpen = true; // So we can set focus on the search field when the flyout opens.\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 0-based index of the currently focused option.\r\n   */\r\n  @State() cursorPosition: number = -1;\r\n\r\n  /**\r\n   * Toggle to re-render the whole component.\r\n   */\r\n  @State() iLoveJSX: boolean = false;\r\n\r\n\r\n  searchId = utils.generateUniqueId();\r\n  didJustOpen = false;\r\n\r\n\r\n\r\n  @Listen(\"click\", {\r\n    target: \"body\"\r\n  })\r\n  handleDefocusingClick() {\r\n    if (this.el.querySelectorAll(\":focus\").length == 0 && this.isOpen) {\r\n      this.closeFlyout();\r\n    }\r\n  }\r\n\r\n\r\n\r\n  @Listen(\"keydown\")\r\n  handleKeyup(ev: KeyboardEvent) {\r\n\r\n    let key = ev.key.toString().toLowerCase();\r\n    let dropdownElement = this.el.querySelector(\".yeti-dropdown\") as HTMLElement;\r\n\r\n    switch (key) {\r\n\r\n      // Handle potential tabout\r\n      case \"tab\": {\r\n\r\n        setTimeout(() => {\r\n          \r\n          if (!this.el.contains(document.activeElement)) {\r\n            this.closeFlyout();\r\n          }\r\n\r\n        }, 1);\r\n        \r\n        break;\r\n      }\r\n\r\n\r\n      // Handle arrow navigation\r\n      case \"arrowdown\": {\r\n\r\n        if (this.isOpen) {\r\n          \r\n          // If the user is searching, we first need to switch focus back to the main control so the readout makes sense.\r\n          if (dropdownElement != document.activeElement) {\r\n            dropdownElement?.focus();\r\n          }\r\n\r\n          this.cursorPosition = this.getNextVisibleCursorPosition();\r\n          ev.preventDefault();\r\n\r\n        } else if (ev.altKey) {\r\n\r\n          this.cursorPosition = 0;\r\n          this.openFlyout();\r\n          ev.preventDefault();\r\n\r\n        }\r\n\r\n        break;\r\n      }\r\n\r\n\r\n      // Handle arrow navigation\r\n      case \"arrowup\": {\r\n\r\n        if (this.isOpen) {\r\n          \r\n          // If the user is searching, we first need to switch focus back to the main control so the readout makes sense.\r\n          if (dropdownElement != document.activeElement) {\r\n            dropdownElement?.focus();\r\n          }\r\n\r\n          // this.cursorPosition = (this.cursorPosition - 1 + this.options.length) % this.options.length;\r\n          this.cursorPosition = this.getPreviousVisibleCursorPosition();\r\n          ev.preventDefault();\r\n\r\n        } else if (ev.altKey) {\r\n\r\n          this.openFlyout();\r\n          ev.preventDefault();\r\n\r\n        }\r\n\r\n        break;\r\n      }\r\n\r\n\r\n      // Handle escape navigation\r\n      case \"escape\": {\r\n\r\n        if (this.isOpen) {\r\n\r\n          // If the user is searching, escape should just return focus to the main element.\r\n          // if (dropdownElement != document.activeElement) {\r\n          //   dropdownElement?.focus();\r\n          //   ev.preventDefault();\r\n          //   break;\r\n          // }\r\n\r\n          dropdownElement?.focus();\r\n          this.closeFlyout();\r\n          ev.preventDefault();\r\n        }\r\n\r\n        break;\r\n      }\r\n\r\n\r\n      // Handle flyout open/close toggling enter/space or selection-making enter/space\r\n      case \"enter\":\r\n      case \" \": {\r\n\r\n        // Check to see if this happened while selecting something.\r\n        ev.preventDefault();\r\n        let target = ev.target as HTMLElement;\r\n\r\n        // First check if a clear option has focus\r\n        if (target.classList.contains(\"yeti-dropdown-puck\") || target.classList.contains(\"yeti-input-clear\")) {\r\n          target.click();\r\n          break;\r\n        } else {\r\n\r\n          // Next check if the cursor is in a search field\r\n          if (dropdownElement != document.activeElement) {\r\n            console.log(\"Hit enter or space while in the search field.\");\r\n          }\r\n        \r\n          // Next check if the cursor is on a selection\r\n          else if (this.cursorPosition >= 0) {\r\n\r\n            // Toggle selection on the option at this cursor position.\r\n            this.handleOptionClick(this.cursorPosition);\r\n          \r\n          } else {\r\n\r\n            // User isn't selecting or activating clear puck, so just toggle the flyout open/close state.\r\n            this.toggleFlyout();\r\n          }\r\n        }\r\n\r\n        break;\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n\r\n\r\n  @Listen(\"searchFieldClear\")\r\n  handleSearchInputClear() {\r\n    (this.el.querySelector(\".yeti-dropdown-search\") as HTMLInputElement).value = \"\";\r\n    this.resetAllOptionsVisibility();\r\n    this.searchString = \"\";\r\n  }\r\n\r\n\r\n\r\n  getNextVisibleCursorPosition() {\r\n    // Get the index of the option in this.options that corresponds to the next visible option, wrapping to the start of the array if necessary, or returning the original cursor position if no other options are visible.\r\n    \r\n    let numOptions = this.options.length;\r\n    let safeCursorPosition = (this.cursorPosition + numOptions) % numOptions;\r\n    \r\n    // Look for a match between this.cursorPosition and the end of the array.\r\n    for (\r\n        let i = (safeCursorPosition + 1) % numOptions;\r\n        i != safeCursorPosition;\r\n        i = (i + 1)  %  numOptions\r\n    ) {\r\n\r\n      if (this.options[i].isVisible) {\r\n        return i;\r\n      }\r\n\r\n    }\r\n\r\n    return this.cursorPosition;\r\n\r\n  }\r\n\r\n\r\n\r\n  getPreviousVisibleCursorPosition() {\r\n    // Get the index of the option in this.options that corresponds to the next visible option, wrapping to the start of the array if necessary, or returning the original cursor position if no other options are visible.\r\n    \r\n    let numOptions = this.options.length;\r\n    let safeCursorPosition = (this.cursorPosition + numOptions) % numOptions;\r\n    \r\n    // Look for a match between this.cursorPosition and the end of the array.\r\n    for (\r\n        let i = ((safeCursorPosition - 1) + numOptions) % numOptions;\r\n        i != safeCursorPosition;\r\n        i = ((i - 1) + numOptions)  %  numOptions\r\n    ) {\r\n\r\n      if (this.options[i].isVisible) {\r\n        return i;\r\n      }\r\n\r\n    }\r\n\r\n    return this.cursorPosition;\r\n\r\n  }\r\n\r\n\r\n\r\n  resetAllOptionsVisibility() {\r\n    for (let option of this.options) {\r\n      option.isVisible = true;\r\n    }\r\n  }\r\n\r\n\r\n\r\n  openFlyout() {\r\n    this.isOpen = true;\r\n  }\r\n\r\n\r\n\r\n  closeFlyout() {\r\n    this.isOpen = false;\r\n    this.cursorPosition = -1;\r\n    this.isTouched = true;\r\n    this.searchString = '';\r\n    this.resetAllOptionsVisibility();\r\n    this.readyToVerifySlow.emit();\r\n  }\r\n\r\n\r\n\r\n  toggleFlyout() {\r\n    if (this.isOpen) {\r\n      this.closeFlyout()\r\n    } else {\r\n      this.openFlyout();\r\n    }\r\n  }\r\n\r\n\r\n\r\n  handleFieldBlur(ev) {\r\n    this.isTouched = true;\r\n    this.readyToVerifySlow.emit(ev);\r\n  }\r\n\r\n\r\n\r\n  parseOptionElements(options: HTMLCollection) {\r\n\r\n    let runningInitialValueArray = [];\r\n    let alreadyFoundASelectedOption = false;\r\n\r\n    for (let i = 0; i < options.length; i++) {\r\n      \r\n      let option = options.item(i);\r\n      \r\n      // First, confirm this element is indeed a yeti-dropdown-option element.\r\n      if (option.tagName.toLowerCase() == 'yeti-dropdown-option') {\r\n\r\n        let optionId;\r\n        let selectedState = false;\r\n        let optionValue = \"\";\r\n\r\n        // Set id\r\n        if (option.hasAttribute(\"id\")) {\r\n          optionId = option.getAttribute(\"id\");\r\n        } else {\r\n          optionId = `${this.el.getAttribute(\"id\")}_option${i}`;\r\n        }\r\n\r\n        // Set value\r\n        if (option.hasAttribute(\"value\")) {\r\n          optionValue = option.getAttribute(\"value\");\r\n        } else {\r\n          optionValue = option.textContent;\r\n        }\r\n\r\n\r\n        // Handle selected attribute\r\n        if (this.isMultiselect) {\r\n          selectedState = option.hasAttribute(\"selected\");\r\n        } else {\r\n          selectedState = option.hasAttribute(\"selected\") && !alreadyFoundASelectedOption; // Single select should ignore all but the first selected attribute\r\n          if (selectedState) {\r\n            alreadyFoundASelectedOption = true;\r\n          }\r\n        }\r\n\r\n        this.options.push({\r\n          selected: selectedState,\r\n          label: option.textContent,\r\n          id: optionId,\r\n          value: optionValue,\r\n          isVisible: true\r\n        });\r\n\r\n        if (selectedState) {\r\n          ++this.numSelections;\r\n          runningInitialValueArray.push(optionValue);\r\n        }\r\n\r\n      }\r\n\r\n    } // End for\r\n\r\n    // Initialize value\r\n    this.value = runningInitialValueArray.toString();\r\n\r\n    // Finally, we need to remove the option elements.\r\n    for (let j = options.length - 1; j >= 0; --j) {\r\n      options.item(j).remove();\r\n    }\r\n\r\n  }\r\n\r\n\r\n\r\n  getPlaceholderDisplay() {\r\n    // Returns the string of text that should go in the placeholder area.\r\n\r\n    switch (this.numSelections) {\r\n\r\n      case 0:\r\n        return this.placeholder;\r\n\r\n      case 1:\r\n        for (let i=0; i < this.options.length; i++) {\r\n          \r\n          if (this.options[i].selected) {\r\n            return this.options[i].label;\r\n          }\r\n\r\n        }\r\n\r\n      default: // Multiple selections\r\n        return `${this.numSelections} selections`;\r\n    }\r\n  }\r\n\r\n\r\n\r\n  handleOptionClick(i: number) {\r\n    // i = options index\r\n    let newValue = [];\r\n    let newNumSelections = (this.options[i].selected) ? --this.numSelections : ++this.numSelections;\r\n\r\n    this.options[i].selected = !this.options[i].selected;\r\n    \r\n    for (let j = 0; j < this.options.length; j++) {\r\n\r\n      // Multiselect\r\n      if (this.isMultiselect) {\r\n        \r\n        if (this.options[j].selected) {\r\n          newValue.push(this.options[j].value);\r\n        }\r\n\r\n      // Single-select\r\n      } else {\r\n\r\n        if (i == j) {\r\n          this.value = this.options[i].value;\r\n          newNumSelections = (this.options[j].selected) ? 1 : 0;\r\n          this.closeFlyout();\r\n        } else {\r\n          this.options[j].selected = false;\r\n        }\r\n\r\n      }\r\n      \r\n    }\r\n\r\n    if (this.isMultiselect) {\r\n      this.value = newValue.toString(); // Already updated value in the loop for single-select\r\n    }\r\n\r\n    this.numSelections = newNumSelections;\r\n    this.readyToVerifyFast.emit();\r\n\r\n  }\r\n\r\n\r\n\r\n  handleClearSelections(ev: Event) {\r\n    let fieldElement = this.el.querySelector(\".yeti-dropdown\") as HTMLElement;\r\n    for (let i=0; i<this.options.length; i++) {\r\n      this.options[i].selected = false;\r\n    }\r\n    this.value = \"\";\r\n    this.numSelections = 0;\r\n    fieldElement.focus();\r\n    ev.stopPropagation();\r\n    this.readyToVerifySlow.emit();\r\n    this.readyToVerifyFast.emit();\r\n  }\r\n\r\n\r\n\r\n  handleSearchKeyUp(ev: KeyboardEvent) {\r\n    let searchField = this.el.querySelector(\".yeti-dropdown-search\") as HTMLInputElement;\r\n    let searchString = searchField.value;\r\n\r\n    if (!this.isSearchable) {\r\n      return;\r\n    }\r\n\r\n    if (ev.key == \" \") {\r\n      ev.stopImmediatePropagation();\r\n    }\r\n\r\n    for (let option of this.options) {\r\n      \r\n      if (searchString?.toLowerCase() != \"\" && option.label?.toLowerCase()?.indexOf( searchString.toLowerCase() ) < 0) {\r\n        option.isVisible = false;\r\n      } else {\r\n        option.isVisible = true;\r\n      }\r\n\r\n    }\r\n\r\n    this.searchString = searchString;\r\n  }\r\n\r\n\r\n\r\n  componentWillLoad() {\r\n    // Set up ids and handle any <yeti-dropdown-option> elements\r\n    let optionElements = this.el.children;\r\n\r\n    // Set up ids\r\n    let componentId = this.el.getAttribute(\"id\");\r\n\r\n    if (!componentId || componentId == \"\") {\r\n      componentId = utils.generateUniqueId();\r\n      this.el.setAttribute(\"id\", componentId);\r\n    }\r\n\r\n    this.comboboxId = (this.comboboxId != \"\") ? this.comboboxId : `${componentId}_combobox`;\r\n    this.formName = (this.formName != \"\") ? this.formName : componentId;\r\n\r\n    this.flyoutId = (this.flyoutId != \"\") ? this.flyoutId : `${componentId}_flyout`;\r\n\r\n\r\n    // Look for and handle any <yeti-dropdown-option> elements.\r\n    if (optionElements.length > 0) {\r\n      \r\n      this.parseOptionElements(optionElements);\r\n\r\n    }\r\n  }\r\n\r\n\r\n\r\n  componentDidRender() {\r\n    // If the cursor is over an option, make sure it's visible.\r\n    if (this.isOpen) {\r\n      // The flyout is open. If one of the options is being hovered over then we want to scroll it into view.\r\n      // If not, then we'll scroll the whole flyout into view.\r\n      let flyout = this.el.querySelector(\".yeti-dropdown-flyout\");\r\n      let hoveredOption = this.el.querySelector(\".yeti-dropdown-option__hover\");\r\n      let thingToScrollIntoView = (hoveredOption) ? hoveredOption : flyout;\r\n\r\n      if (this.isSearchable && this.didJustOpen) {\r\n        (this.el.querySelector(\".yeti-dropdown-search\") as HTMLElement)?.focus();\r\n        this.didJustOpen = false;\r\n      }\r\n\r\n      thingToScrollIntoView.scrollIntoView({\r\n        behavior: \"smooth\",\r\n        block: \"nearest\"\r\n      });\r\n    }\r\n  }\r\n\r\n\r\n\r\n  render() {\r\n\r\n    let comboboxClasses = 'yeti-dropdown';\r\n    let flyoutClass = 'yeti-dropdown-flyout';\r\n\r\n    if (this.wrapperClass != '') {\r\n      comboboxClasses += ' ' + this.wrapperClass;\r\n    }\r\n\r\n    if (this.isValid == false) {\r\n      comboboxClasses += ' yeti-dropdown__error';\r\n    }\r\n\r\n    flyoutClass += (this.isOpen) ? \" yeti-dropdown-flyout__open\" : \"\";\r\n\r\n    if (this.menuAlignment == \"right\") {\r\n      flyoutClass += ' yeti-dropdown-flyout-align-right'\r\n    }\r\n\r\n    return ([\r\n      <div class=\"yeti-dropdown-wrapper\">\r\n\r\n        <div \r\n          tabIndex={0}\r\n          class={comboboxClasses}\r\n          onClick={() => {\r\n            this.isOpen = !this.isOpen;\r\n          }}\r\n          onFocus={() => {\r\n            this.isTouched = true;\r\n          }}\r\n          role=\"combobox\"\r\n          {...((!this.isValid) ? {\"aria-invalid\": 'true'} : {})}\r\n          {...((this.labelledBy != \"\") ? {\"aria-labeledby\": this.labelledBy} : {})}\r\n          {...((this.describedBy != \"\") ? {\"aria-describedby\": this.describedBy} : {})}\r\n          aria-controls={this.flyoutId}\r\n          aria-expanded={this.isOpen}\r\n          aria-haspopup=\"listbox\"\r\n          {...((this.isOpen && this.cursorPosition >= 0) ? { \"aria-activedescendant\": this.options[this.cursorPosition].id } : {})}\r\n          id={this.comboboxId}\r\n          {...((this.isSearchable) ? { \"aria-description\": \"searchable\" } : {})}\r\n        >\r\n\r\n          <span \r\n            class=\"yeti-dropdown-placeholder\"\r\n            title={this.getPlaceholderDisplay()}\r\n          >{this.getPlaceholderDisplay()}\r\n          \r\n          {(this.numSelections > 1) ?\r\n            <span class=\"yeti-a11y-hidden\">{this.value}</span>\r\n          :\r\n            \"\"\r\n          }\r\n          </span>\r\n\r\n\r\n          { (/*this.isMultiselect && */this.showClear && this.numSelections > 0) ? // Clear puck\r\n\r\n            (<button class=\"yeti-dropdown-puck\" title=\"Clear all selections\" onClick={ (ev) => { this.handleClearSelections(ev); ev.preventDefault() }}>\r\n              <span class=\"yeti-a11y-hidden\">Clear all selections</span>\r\n              <span class=\"material-icons yeti-dropdown-puck-icon\" aria-hidden=\"true\">cancel</span>\r\n            </button>)\r\n\r\n          :\r\n\r\n            \"\"\r\n\r\n          }\r\n\r\n        </div>\r\n\r\n        \r\n        <div class={flyoutClass}>\r\n\r\n          {/*Search field */\r\n\r\n            (this.isSearchable) ?\r\n\r\n              <div class=\"yeti-dropdown-search-wrapper\">\r\n                {/* <input \r\n                  type=\"search\" \r\n                  class=\"yeti-dropdown-search\" \r\n                  placeholder='Type to search' \r\n                  onKeyUp={(e) => { this.handleSearchKeyUp(e); }}\r\n                  aria-controls={this.flyoutId}\r\n                  autocomplete='off'\r\n                  id={this.searchId}\r\n                  value={this.searchString}\r\n                  {...(!this.isOpen ? {\"tabindex\": \"-1\"} : {})}\r\n                /> */}\r\n                \r\n                <yeti-input\r\n                  input-class=\"yeti-dropdown-search\"\r\n                  placeholder='Type to search' \r\n                  onKeyUp={(e) => { this.handleSearchKeyUp(e); }}\r\n                  aria-controls={this.flyoutId}\r\n                  inputId={this.searchId}\r\n                  value={this.searchString}\r\n                  autocomplete=\"off\"\r\n                  {...(!this.isOpen ? {\"input-tabindex\": \"-1\"} : {})}\r\n                />\r\n              </div>\r\n\r\n            :\r\n\r\n              \"\"\r\n\r\n          }\r\n\r\n        \r\n          <ul\r\n            class=\"yeti-dropdown-options\"\r\n            id={this.flyoutId}\r\n            role=\"listbox\"\r\n            aria-multiselectable=\"true\"\r\n            {...((this.labelledBy != \"\") ? {\"aria-labeledby\": this.labelledBy} : {})}\r\n            {...((this.isOpen && this.cursorPosition >= 0) ? { \"aria-activedescendant\": this.options[this.cursorPosition].id } : {})}\r\n          >\r\n\r\n            {this.options.map((option, i) => {\r\n\r\n                let optionClass = (this.cursorPosition == i) ? \"yeti-dropdown-option yeti-dropdown-option__hover\" : \"yeti-dropdown-option\";\r\n              \r\n                return (\r\n\r\n                  (option.isVisible) ?\r\n\r\n                    <li \r\n                      id={option.id} \r\n                      key={option.id}\r\n                      role=\"option\"\r\n                      aria-selected={`${option.selected}`}\r\n                    >\r\n                      <button class={optionClass} tabIndex={-1} onClick={(ev) => { this.handleOptionClick(i); ev.preventDefault(); }}>\r\n\r\n\r\n                        {\r\n                          (this.isMultiselect) ?\r\n                        \r\n                            <span class=\"yeti-dropdown-option-checkbox\">\r\n                              <span class=\"material-icons\" aria-hidden=\"true\">{(option.selected) ? \"check_box\" : \"check_box_outline_blank\"}</span>\r\n                            </span>\r\n\r\n                          :\r\n\r\n                            \"\"\r\n                        }\r\n\r\n                        \r\n                        <span class=\"yeti-dropdown-option-label\">{option.label}</span>\r\n\r\n\r\n                        {\r\n                          (!this.isMultiselect && option.selected) ?\r\n\r\n                            <yeti-icon iconCode=\"check\" aria-hidden=\"true\" iconClass='yeti-typo-size-4'></yeti-icon>\r\n\r\n                          :\r\n\r\n                            \"\"\r\n                        }\r\n\r\n\r\n                      </button>\r\n                    </li>\r\n\r\n                  :\r\n\r\n                    \"\"\r\n                )\r\n              }\r\n            \r\n            )}\r\n\r\n          </ul>\r\n\r\n        </div>\r\n\r\n      </div>\r\n    ]);\r\n  }\r\n\r\n}","import { Component, Prop, h, State, Event, EventEmitter, Element, Listen, Watch } from '@stencil/core';\r\nimport { utils, YetiMenuButtonOption } from '../../utils/utils';\r\n\r\n@Component({\r\n  tag: 'yeti-menu-button',\r\n  shadow: false,\r\n})\r\nexport class YetiMenuButton {\r\n\r\n  @Element() el: HTMLElement;\r\n\r\n  /**\r\n   * Fires when the selected value of the Menu Button becomes a different value.\r\n   */\r\n  @Event({ bubbles: true }) menuButtonChange: EventEmitter;\r\n\r\n  /**\r\n   * Fires whenever the user selects a value, even if its the same as it was before.\r\n   */\r\n  @Event({ bubbles: true }) menuButtonSelectionMade: EventEmitter;\r\n\r\n  /**\r\n   * CSS classlist to add to the Menu Button pattern's outer wrapper.\r\n   */\r\n  @Prop() wrapperClass: string = '';\r\n\r\n  /**\r\n   * CSS classlist to add to the Menu Button's button element.\r\n   */\r\n  @Prop() buttonClass: string = '';\r\n\r\n  /**\r\n   * CSS classlist to add to the Menu Button's menu element.\r\n   */\r\n  @Prop() menuClass: string = '';\r\n\r\n  /**\r\n   * id to apply to the Menu Button's button element. Will be auto-populated with a unique id if one is not provided.\r\n   */\r\n  @Prop({\r\n    mutable: true,\r\n    reflect: true\r\n  }) buttonId: string = \"\";\r\n\r\n  /**\r\n   * Sets a specific type of the button (see the Yeti Button pattern for more info): primary, secondary, tertiary, danger, or ghost.\r\n   */\r\n  @Prop() buttonType?: string = \"\";\r\n\r\n  @Prop({\r\n    mutable: true,\r\n    reflect: true\r\n  }) menuId: string = \"\";\r\n\r\n  /**\r\n   * Text that appears within the optional tooltip bubble.\r\n   */\r\n  @Prop() tooltipText: string = \"Options\";\r\n\r\n  /**\r\n   * Token list comprising left | right and/or above | below to align the menu relative to the button.\r\n   */\r\n  @Prop() menuAlignment: string = \"\";\r\n\r\n  /**\r\n   * Whether to show a tooltip on hover/focus of the button or not.\r\n   */\r\n  @Prop() hasTooltip: boolean = true;\r\n\r\n  /**\r\n   * The value of the control (will correspond to the value of one of the options in the menu).\r\n   */\r\n  @Prop({\r\n    mutable: true,\r\n    reflect: true\r\n  }) value: string = '';\r\n  @Watch('value')\r\n  handleValueChange(newValue: string, oldValue: string) {\r\n    this.menuButtonChange.emit({\r\n      \"newValue\": newValue,\r\n      \"oldValue\": oldValue\r\n    });\r\n  }\r\n\r\n  /**\r\n   * id of an outside element the control's aria-labelledby attribute references.\r\n   */\r\n  @Prop() labelledBy: string = \"\";\r\n\r\n  /**\r\n   * id of an outside element the control's aria-describedby attribute reference.\r\n   */\r\n  @Prop() describedBy: string = \"\";\r\n\r\n  /**\r\n   * Array of YetiMenuButtonOptions (see utils.js) that describe the component's representation of its options.\r\n   */\r\n  @State() options: YetiMenuButtonOption[] = [];\r\n\r\n  /**\r\n   * Whether the user has focused and blurred (i.e. interacted with) the component.\r\n   */\r\n  @State() isTouched: boolean = false;\r\n\r\n  /**\r\n   * Toggle to re-rerender the component.\r\n   */\r\n  @State() iLoveJSX: boolean = false;\r\n\r\n  /**\r\n   * Whether the menu is visible or not.\r\n   */\r\n  @State() isOpen: boolean = false;\r\n\r\n  /**\r\n   * 0-based index of the currently focused option relative to the whole menu.\r\n   */\r\n  @State() cursorPosition: number = -1;\r\n\r\n  private justMadeASelection: boolean = false;\r\n\r\n  private hasCustomButtonContents: boolean = false;\r\n\r\n\r\n  @Listen(\"click\", {\r\n    target: \"body\",\r\n    capture: true\r\n  })\r\n  handleDefocusingClick() {\r\n    if (this.el.querySelectorAll(\":focus\").length == 0 && this.isOpen) {\r\n      this.closeMenu();\r\n    }\r\n  }\r\n\r\n\r\n\r\n  @Listen(\"keydown\")\r\n  handleKeydown(ev: KeyboardEvent) {\r\n\r\n    let key = ev.key.toString().toLowerCase();\r\n\r\n    switch (key) {\r\n\r\n      // Handle potential tabout\r\n      case \"tab\": {\r\n\r\n        this.closeMenu();\r\n        \r\n        break;\r\n      }\r\n\r\n\r\n      // Handle down arrow\r\n      case \"arrowdown\": {\r\n\r\n        // Menu is already open, focus on next option.\r\n        if (this.isOpen) {\r\n\r\n          this.cursorPosition = (this.cursorPosition + 1) % this.options.length;\r\n\r\n        // Menu isn't open, so open it and focus on the first option.\r\n        } else {\r\n          \r\n          this.cursorPosition = 0;\r\n          this.openMenu();\r\n        \r\n        }\r\n        \r\n        ev.preventDefault();\r\n\r\n        break;\r\n      }\r\n\r\n\r\n      // Handle up arrow\r\n      case \"arrowup\": {\r\n\r\n        // Menu is already open, focus on previous option.\r\n        if (this.isOpen) {\r\n\r\n          this.cursorPosition = (this.cursorPosition - 1 + this.options.length) % this.options.length;\r\n          \r\n        // Menu isn't open, so open it and focus on the last option.\r\n        } else {\r\n\r\n          this.cursorPosition = this.options.length - 1;\r\n          this.openMenu();\r\n\r\n        }\r\n        \r\n        ev.preventDefault();\r\n\r\n        break;\r\n      }\r\n\r\n\r\n      // Handle space, which should open the menu but do nothing else.\r\n      case \" \": {\r\n\r\n        // Check to see if the menu is open.\r\n        if (!this.isOpen) {\r\n          this.cursorPosition = 0;\r\n          this.openMenu();\r\n        }\r\n\r\n        ev.preventDefault();\r\n\r\n        break;\r\n      }\r\n\r\n\r\n      // Handle enter\r\n      case \"enter\": {\r\n\r\n        // Check to see if the menu is open.\r\n        if (!this.isOpen) {\r\n          \r\n          this.openMenu();\r\n          this.cursorPosition = 0;\r\n\r\n          ev.preventDefault();\r\n        }\r\n\r\n        // Menu is already open, so the user just made a selection.\r\n        else {\r\n\r\n          this.value = this.options[this.cursorPosition].label;\r\n          this.justMadeASelection = true;\r\n          this.closeMenu();\r\n          // Note we're not preventing default here, so if the option was a link, that link will still work.\r\n        \r\n        }\r\n\r\n        break;\r\n      }\r\n\r\n\r\n      // Home\r\n      case \"home\": {\r\n        \r\n        // If the menu is open then move the cursor to the first option.\r\n        if (this.isOpen) {\r\n\r\n          this.cursorPosition = 0;\r\n\r\n        }\r\n\r\n        ev.preventDefault();\r\n\r\n        break;\r\n      }\r\n\r\n\r\n      // End\r\n      case \"end\": {\r\n        \r\n        if (this.isOpen) {\r\n\r\n          this.cursorPosition = this.options.length - 1;\r\n\r\n        }\r\n\r\n        ev.preventDefault();\r\n\r\n        break;\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n\r\n\r\n  openMenu() {\r\n    this.isOpen = true;\r\n  }\r\n\r\n\r\n\r\n  closeMenu() {\r\n    this.isOpen = false;\r\n    this.cursorPosition = -1;\r\n    this.isTouched = true;\r\n  }\r\n\r\n\r\n\r\n  toggleMenu() {\r\n    if (this.isOpen) {\r\n      this.closeMenu()\r\n    } else {\r\n      this.openMenu();\r\n    }\r\n  }\r\n\r\n\r\n\r\n  parseChildTags() {\r\n\r\n    let options = this.el.querySelectorAll(\"yeti-menu-button-option\");\r\n    let buttonLabel = this.el.querySelector(\"yeti-menu-button-contents\");\r\n\r\n    this.options = (options && options.length && options.length > 0) ? [] : this.options;\r\n\r\n    for (let i = 0; i < options.length; i++) {\r\n      \r\n      let option = options.item(i) as Element;\r\n      \r\n      // First, confirm this element is indeed a yeti-menu-button-option element.\r\n      if (option.tagName.toLowerCase() == 'yeti-menu-button-option') {\r\n\r\n        let optionObject: YetiMenuButtonOption = {\r\n          label: \"\",\r\n          id: \"\",\r\n          href: \"\",\r\n          value: \"\",\r\n          hasHTML: false\r\n        };\r\n\r\n        let optionId = option.getAttribute(\"id\");\r\n\r\n        optionObject.id = (optionId && optionId != \"\") ? optionId : `${this.el.getAttribute(\"id\")}_option${i}`;\r\n        optionObject.label = (option as HTMLElement).innerText.trim().replace(/\\t/g, '');\r\n        optionObject.label = optionObject.label.replace(/\\n/g, ' ');\r\n\r\n        // Check to see if it has a href attribute.\r\n        if (option.hasAttribute(\"href\") && option.getAttribute(\"href\") != \"\") {\r\n          optionObject.href = option.getAttribute(\"href\");\r\n\r\n          if (option.hasAttribute(\"target\") && option.getAttribute(\"target\") != \"\") {\r\n            optionObject.target = option.getAttribute(\"target\");\r\n          }\r\n\r\n          if (option.hasAttribute(\"download-as\") && option.getAttribute(\"download-as\") != \"\") {\r\n            optionObject.downloadAs = option.getAttribute(\"download-as\");\r\n          }\r\n        }\r\n\r\n        // Check to see if it's normal or fancy (i.e. has HTML)\r\n        if (option.childNodes.length != 1 || option.firstChild.nodeType != 3) { // If there's not just a single text node\r\n\r\n          optionObject.hasHTML = true;\r\n\r\n          // Create a slot element and move all childNodes to it.\r\n          let div = document.createElement(\"div\");\r\n          div.setAttribute(\"slot\", optionObject.id);\r\n\r\n          while (option.childNodes.length > 0) {\r\n            div.appendChild(option.childNodes[0]);\r\n          }\r\n\r\n          this.el.appendChild(div);\r\n\r\n          optionObject.innerHTML = option.innerHTML;\r\n          \r\n        }\r\n\r\n        this.options.push(optionObject);\r\n\r\n      }\r\n\r\n    } // End for\r\n\r\n    // Handle the button label (if it exists)\r\n    if (buttonLabel) {\r\n      this.hasCustomButtonContents = true;\r\n      buttonLabel.setAttribute(\"slot\", \"buttonContents\");\r\n    }\r\n\r\n    // Finally, we need to remove the option elements.\r\n    for (let j = options.length - 1; j >= 0; --j) {\r\n      options.item(j).remove();\r\n    }\r\n\r\n  }\r\n\r\n\r\n\r\n  unwrapButtonContents() {\r\n    let wrapper = this.el.querySelector(\"yeti-menu-button-contents\");\r\n    if (wrapper) {\r\n      wrapper.replaceWith(...Array.from(wrapper.childNodes));\r\n    }\r\n  }\r\n\r\n\r\n\r\n  renderMenuItems() {\r\n    // Creates the <option>s for the actual <select>.\r\n    let items = [];\r\n    for (let i=0; i<this.options.length; i++) {\r\n      // let optionActual = <option value={this.options[i].label} selected={this.options[i].selected}>{this.options[i].label}</option>;\r\n      // optionsActual.push(optionActual);\r\n\r\n      let option = this.options[i];\r\n      let linkOrButtonElement;\r\n      let item;\r\n      //let listItemId = `${option.id}_item${i}`;\r\n      let listItemId = `${option.id}`;\r\n\r\n      // See if it's a link\r\n      if (option.href) {\r\n        linkOrButtonElement = <a \r\n          href={option.href} \r\n          {...((option.target != \"\" && !option.downloadAs) ? {\"target\": option.target} : {})}\r\n          {...((option.downloadAs && option.downloadAs != \"\") ? {\"download\": option.downloadAs} : {})}\r\n          class=\"yeti-menu_button-menu-item-link\" \r\n          role=\"menuitem\" \r\n          tabindex=\"-1\"\r\n          data-option-index={i}\r\n          onClick={(ev) => { this.handleOptionClick(i, ev, true) }}>\r\n            \r\n            {(option.hasHTML) ? <slot name={option.id}></slot> : option.label}\r\n            \r\n        </a>\r\n      }\r\n\r\n      // Nope, it's a button.\r\n      else {\r\n        linkOrButtonElement = <button \r\n          class=\"yeti-menu_button-menu-item-button\" \r\n          role=\"menuitem\" \r\n          type=\"button\"\r\n          tabindex=\"-1\"\r\n          data-option-index={i}\r\n          onClick={(ev) => { this.handleOptionClick(i, ev) }}>\r\n\r\n            {(option.hasHTML) ? <slot name={option.id}></slot> : option.label}\r\n\r\n        </button>\r\n      }\r\n\r\n      item = <li \r\n        class=\"yeti-menu_button-menu-item\" \r\n        role=\"presentation\"\r\n        id={listItemId}\r\n        key={listItemId}\r\n      >{linkOrButtonElement}</li>\r\n\r\n      items.push(item);\r\n\r\n    }\r\n\r\n    return items;\r\n  }\r\n\r\n\r\n\r\n  handleOptionClick(i: number, ev: Event, isLink: boolean = false) {\r\n\r\n    this.value = this.options[i].label;\r\n    this.justMadeASelection = true;\r\n    this.closeMenu();\r\n    if (!isLink) {\r\n      ev.preventDefault();\r\n    }\r\n  }\r\n\r\n\r\n\r\n  handleActualFocus() {\r\n    let facade = this.el.querySelector(\".yeti-multiselect\") as HTMLElement;\r\n    if (facade) {\r\n      facade.focus();\r\n    }\r\n  }\r\n\r\n\r\n\r\n  handleButtonClick(ev: Event) {\r\n    this.isOpen = !this.isOpen;\r\n    ev.preventDefault();\r\n  }\r\n\r\n\r\n\r\n  renderButton(buttonClass: string) {\r\n    return <button \r\n      class={buttonClass}\r\n      type=\"button\"\r\n      aria-haspopup=\"true\"\r\n      {...((this.isOpen) ? {\"aria-expanded\": \"true\"} : {})}\r\n      aria-controls={this.menuId} \r\n      id={this.buttonId}\r\n      role=\"button\"\r\n      onClick={(ev) => {\r\n        this.handleButtonClick(ev)\r\n    }}>\r\n\r\n      {(this.hasCustomButtonContents) ?\r\n        <slot name=\"buttonContents\"></slot>\r\n      :\r\n        [\r\n          <span class=\"material-icons\" aria-hidden=\"true\">more_vert</span>,\r\n          <span class=\"yeti-a11y-hidden\">Options</span>\r\n        ]\r\n      }\r\n    </button>\r\n  }\r\n\r\n\r\n\r\n  componentWillLoad() {\r\n    // Set ids\r\n    let elementId = this.el.getAttribute(\"id\");\r\n  \r\n    if (!elementId || elementId == \"\") {\r\n\r\n      this.el.setAttribute(\"id\", utils.generateUniqueId());\r\n\r\n    }\r\n\r\n    this.buttonId = (this.buttonId != \"\") ? this.buttonId : `${elementId}_button`;\r\n    this.menuId = (this.menuId != \"\") ? this.menuId : `${elementId}_menu`;\r\n\r\n  }\r\n\r\n\r\n\r\n  componentWillRender() {\r\n    // Look for and handle any <yeti-menu-button-*> tags.\r\n    this.parseChildTags();\r\n  }\r\n\r\n\r\n\r\n  componentDidRender() {\r\n\r\n    // Unwrap button contents, if necessary\r\n    this.unwrapButtonContents();\r\n\r\n    // If the cursor is over an option, make sure it's visible.\r\n    let selector = '[data-option-index=\"' + this.cursorPosition + '\"';\r\n    let linkOrButtonElement = this.el.querySelector(selector) as HTMLElement;\r\n    let menu = this.el.querySelector(\".yeti-menu_button-menu\");\r\n\r\n    if (linkOrButtonElement) {\r\n      \r\n      linkOrButtonElement.focus();\r\n\r\n    }\r\n\r\n    if (this.isOpen) {\r\n\r\n      menu.scrollIntoView({\r\n        behavior: \"smooth\",\r\n        block: \"nearest\"\r\n      });\r\n\r\n    }\r\n\r\n    if (this.justMadeASelection) {\r\n\r\n      let button = this.el.querySelector('.yeti-menu_button-button') as HTMLElement;\r\n\r\n      if (button) {\r\n\r\n        button.focus();\r\n        button.scrollIntoView({\r\n          behavior: \"smooth\",\r\n          block: \"nearest\"\r\n        });\r\n\r\n      }\r\n\r\n      this.menuButtonSelectionMade.emit({\r\n        \"value\": this.value\r\n      });\r\n\r\n      this.justMadeASelection = false;\r\n    }\r\n\r\n  }\r\n\r\n\r\n\r\n  render() {\r\n\r\n    let wrapperClass = 'yeti-menu_button';\r\n    let buttonClass = 'yeti-menu_button-button';\r\n    let menuClass = 'yeti-menu_button-menu';\r\n    let tooltipId = `${this.el.getAttribute(\"id\")}_tooltip`;\r\n\r\n    if (this.menuAlignment.indexOf(\"right\") > -1) {\r\n      wrapperClass += ' yeti-menu_button-right_aligned';\r\n    }\r\n\r\n    if (this.isOpen) {\r\n      wrapperClass += ' yeti-menu_button__open';\r\n    }\r\n\r\n    if (this.buttonType && this.buttonType != \"\") {\r\n      buttonClass = `${buttonClass} yeti-menu_button-button-mimic ${buttonClass}-${this.buttonType}`;\r\n    }\r\n\r\n    wrapperClass += (this.wrapperClass && this.wrapperClass != \"\") ? \" \" + this.wrapperClass : \"\";\r\n    buttonClass += (this.buttonClass && this.buttonClass != \"\") ? \" \" + this.buttonClass : \"\";\r\n    menuClass += (this.menuClass && this.menuClass != \"\") ? \" \" + this.menuClass : \"\";\r\n\r\n    return ([\r\n      <div class={wrapperClass}>\r\n\r\n        {\r\n          (this.hasTooltip) ?\r\n\r\n            <yeti-tooltip text={this.tooltipText} id={tooltipId} slotId={this.buttonId} tipId={`${this.buttonId}_tooltip`}>\r\n              {this.renderButton(buttonClass)}\r\n            </yeti-tooltip>\r\n\r\n          :\r\n\r\n            this.renderButton(buttonClass)\r\n        }\r\n\r\n        \r\n        <ul class={menuClass} role=\"menu\" id={this.menuId} aria-labelledby={this.buttonId} key={this.menuId}>\r\n\r\n          {this.renderMenuItems()}\r\n\r\n        </ul>\r\n\r\n      </div>\r\n    ]);\r\n  }\r\n\r\n}\r\n"],"mappings":"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","ignoreList":[]}