{"version":3,"names":["YetiField","this","tipId","utils","generateUniqueId","inputId","validateLabel","newValue","isInvalid","Error","handleReadyToVerifySlow","ev","childControl","target","autovalidate","required","value","errorMessage","label","isValid","nodeName","toLowerCase","render","cssClass","fieldClass","h","class","htmlFor","type","inputName","defaultValue","Object","assign","fieldMaxlength","tip","id"],"sources":["src/components/yeti-field/yeti-field.tsx"],"sourcesContent":["import { Component, Prop, h, State, Watch, Listen } from '@stencil/core';\nimport { utils } from '../../utils/utils';\n\n@Component({\n  tag: 'yeti-field',\n  shadow: false,\n})\nexport class YetiField {\n\n  /**\n   * id that will be assigned to the actual input element. A unique one will be assigned if one is not provided.\n   */\n  @Prop() inputId: string = utils.generateUniqueId();\n\n  /**\n   * name that will be assigned to the actual input element. id will be assigned if one is not provided.\n   */\n  @Prop() inputName: string = this.inputId;\n\n  /**\n   * type that will be assigned to the actual input element.\n   */\n  @Prop() type: string = \"text\";\n\n  /**\n   * CSS classlist that will be assigned to the containing field element (probably a div).\n   */\n  @Prop() fieldClass: string = \"\";\n\n  /**\n   * maximum length for the field.\n   */\n  @Prop() fieldMaxlength?: number = 0;\n  \n  /**\n   * Mandatory value for the label of the field.\n   */\n  @Prop() label!: string;\n  @Watch('label')\n  validateLabel(newValue: string) {\n    // Label must have a non-empty value.\n    const isInvalid = typeof newValue !== 'string' || newValue === '';\n    if (isInvalid) {\n      throw new Error('yeti-field must have a non-empty label attribute');\n    }\n  }\n\n  /**\n   * Value for the optional input tip that appears at the bottom of the field.\n   */\n  @Prop() tip: string = \"\";\n\n  /**\n   * Whether the field is required to have a valid value by the greater form.\n   */\n  @Prop() required: boolean = false;\n\n  /**\n   * Error message that appears when the field is invalid. Can be updated at any time.\n   */\n  @Prop({mutable: true}) errorMessage: string = 'Error: please correct this field.'\n\n  /**\n   * Whether the input is currently valid or invalid.\n   */\n  @Prop({\n    mutable: true,\n    reflect: true\n  }) isValid: boolean = true;\n\n  /**\n   * Default value of the field's input.\n   */\n  @Prop() defaultValue: string = '';\n\n  /**\n   * Determines whether the field should attempt to validate itself or merely pass through any readyToVerify events from its input.\n   */\n  @Prop() autovalidate: boolean = true;\n\n  /**\n   * Tracks whether the field's input has been focused and then blurred (i.e. if the user has interacted with it yet).\n   */\n  @State() isDirty: boolean = false;\n  \n  @Listen('readyToVerifySlow', { capture: true })\n  handleReadyToVerifySlow(ev) {\n\n    let childControl = ev.target;\n\n    if (this.autovalidate == false) {\n      return;\n    }\n\n    if (this.required) {\n\n      // Autoverification is on, this field is required, and the child component just notified us that it's ready for verification.\n\n      // First, regardless of whether it's an input or date-picker, it can't be empty.\n      if (childControl.value == \"\") {\n\n        this.errorMessage = `${this.label} field is required.`\n        this.isValid = false;\n        return;\n\n      }\n      \n    } else if (childControl.nodeName.toLowerCase() == \"yeti-date-picker\") {\n\n      // Second, if it's a non-empty date-picker, see if it's a valid date.\n\n      if (!childControl.isValid) {\n\n        // The date-picker already validates itself. We just need to check its status.\n        this.errorMessage = 'Enter the date in mm/dd/yyyy format.'\n        this.isValid = false;\n        return;\n\n      }\n    }\n\n    this.isValid = true;\n\n  }\n\n  tipId = utils.generateUniqueId();\n\n\n\n  render() {\n\n    let cssClass = \"yeti-form-field\";\n\n    this.validateLabel(this.label);\n\n    if (this.fieldClass != \"\") {\n      cssClass =\"yeti-form-field \" + this.fieldClass;\n    }\n\n    return (\n      <div class={cssClass}>\n\n        <label htmlFor={this.inputId} class=\"yeti-form-label\">{this.label}{this.required ? ' (required)' : null}</label>\n\n        { \n          (this.type == \"date\") ?\n\n            <yeti-date-picker\n              input-id={this.inputId}\n              input-name={this.inputName}\n              value={this.defaultValue}\n              required={this.required}\n              is-valid={this.isValid}\n              described-by={this.tipId}\n            ></yeti-date-picker>\n\n          :\n        \n            <yeti-input \n              input-id={this.inputId} \n              input-class={!this.isValid ? 'yeti-input__error' : null} \n              value={this.defaultValue} \n              required={this.required}\n              is-valid={this.isValid}\n              described-by={this.tipId}\n              {...((this.fieldMaxlength != 0) ? {\"input-maxlength\": this.fieldMaxlength} : {})}\n            ></yeti-input>\n        }\n        \n        {\n          (this.tip != \"\") ?\n\n            <span class=\"yeti-form-tip\" aria-live=\"polite\" id={this.tipId}>{\n\n                  !this.isValid\n                  ? this.errorMessage\n                  : \n                    this.tip\n                    ? this.tip\n                    : null\n\n            }</span>\n\n          :\n            \"\"\n        }\n        \n      </div>\n    );\n  }\n\n}\n"],"mappings":"qFAOaA,EAAS,M,yBAsHpBC,KAAAC,MAAQC,EAAMC,mB,aAjHYD,EAAMC,mB,eAKJH,KAAKI,Q,UAKV,O,gBAKM,G,oBAKK,E,8BAkBZ,G,cAKM,M,kBAKkB,oC,aAQxB,K,kBAKS,G,kBAKC,K,aAKJ,K,CA5C5B,aAAAC,CAAcC,GAEZ,MAAMC,SAAmBD,IAAa,UAAYA,IAAa,GAC/D,GAAIC,EAAW,CACb,MAAM,IAAIC,MAAM,mD,EA2CpB,uBAAAC,CAAwBC,GAEtB,IAAIC,EAAeD,EAAGE,OAEtB,GAAIZ,KAAKa,cAAgB,MAAO,CAC9B,M,CAGF,GAAIb,KAAKc,SAAU,CAKjB,GAAIH,EAAaI,OAAS,GAAI,CAE5Bf,KAAKgB,aAAe,GAAGhB,KAAKiB,2BAC5BjB,KAAKkB,QAAU,MACf,M,OAIG,GAAIP,EAAaQ,SAASC,eAAiB,mBAAoB,CAIpE,IAAKT,EAAaO,QAAS,CAGzBlB,KAAKgB,aAAe,uCACpBhB,KAAKkB,QAAU,MACf,M,EAKJlB,KAAKkB,QAAU,I,CAQjB,MAAAG,GAEE,IAAIC,EAAW,kBAEftB,KAAKK,cAAcL,KAAKiB,OAExB,GAAIjB,KAAKuB,YAAc,GAAI,CACzBD,EAAU,mBAAqBtB,KAAKuB,U,CAGtC,OACEC,EAAA,OAAKC,MAAOH,GAEVE,EAAA,SAAOE,QAAS1B,KAAKI,QAASqB,MAAM,mBAAmBzB,KAAKiB,MAAOjB,KAAKc,SAAW,cAAgB,MAGhGd,KAAK2B,MAAQ,OAEZH,EAAA,+BACYxB,KAAKI,QAAO,aACVJ,KAAK4B,UACjBb,MAAOf,KAAK6B,aACZf,SAAUd,KAAKc,SAAQ,WACbd,KAAKkB,QAAO,eACRlB,KAAKC,QAKrBuB,EAAA,aAAAM,OAAAC,OAAA,YACY/B,KAAKI,QAAO,eACRJ,KAAKkB,QAAU,oBAAsB,KACnDH,MAAOf,KAAK6B,aACZf,SAAUd,KAAKc,SAAQ,WACbd,KAAKkB,QAAO,eACRlB,KAAKC,OACbD,KAAKgC,gBAAkB,EAAK,CAAC,kBAAmBhC,KAAKgC,gBAAkB,KAKhFhC,KAAKiC,KAAO,GAEXT,EAAA,QAAMC,MAAM,gBAAe,YAAW,SAASS,GAAIlC,KAAKC,QAEjDD,KAAKkB,QACJlB,KAAKgB,aAELhB,KAAKiC,IACHjC,KAAKiC,IACL,MAKV,G"}