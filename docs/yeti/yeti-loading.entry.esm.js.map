{"version":3,"file":"yeti-loading.entry.esm.js","sources":["src/components/yeti-loading/yeti-loading.tsx"],"sourcesContent":["import { Component, Prop, h, Element, Watch, Listen } from '@stencil/core';\r\nimport { utils } from '../../utils/utils';\r\n\r\n@Component({\r\n  tag: 'yeti-loading',\r\n  shadow: false,\r\n})\r\nexport class YetiLoading {\r\n\r\n  @Element() el: HTMLElement;\r\n\r\n  /**\r\n   * Whether to display the Loading pattern inline or default mode.\r\n   */\r\n  @Prop() isInline: boolean = false;\r\n\r\n  /**\r\n   * Whether to display the Loading pattern as a modal (covering its parent container) or as an inline-block object.\r\n   */\r\n  @Prop() isModal: boolean = false;\r\n\r\n  /**\r\n   * Tracks whether the Loader is displaying or not.\r\n   */\r\n  @Prop() isActive: boolean = false;\r\n  @Watch('isActive')\r\n  handleFocus(newValue: boolean) {\r\n    // When the Loading becomes active it should take focus away from whatever had it before, but\r\n    // we want to keep track of what that was so we can return focus if Loading becomes inactive.\r\n\r\n    // Becoming active, take focus\r\n    if (newValue) {\r\n      this.shouldStealFocus = true;\r\n      this.setBackgroundElementStyles(true);\r\n    }\r\n\r\n    // Becoming inactive, return focus\r\n    else {\r\n      this.shouldReturnFocus = true;\r\n      this.setBackgroundElementStyles(false);\r\n    }\r\n  }\r\n\r\n\r\n  previouslyFocusedElement: HTMLElement = null; // So we can return focus to wherever the user was when the Loading component appeared.\r\n  shouldStealFocus = false;\r\n  shouldReturnFocus = false;\r\n  slottedContent = null;\r\n\r\n\r\n  setBackgroundElementStyles(modalIsActivating: boolean) {\r\n    if (modalIsActivating) {\r\n        document.body.classList.add(\"yeti-modal-has_active_modal\");\r\n    } else {\r\n        document.body.classList.remove(\"yeti-modal-has_active_modal\");\r\n    }\r\n  }\r\n\r\n\r\n\r\n  @Listen('keydown')\r\n  focusTrap(e) {\r\n    if (this.isActive) {\r\n      e.preventDefault();\r\n    }\r\n  }\r\n\r\n\r\n  componentWillLoad() {\r\n    // Set up ids\r\n    let componentId = this.el.getAttribute(\"id\");\r\n\r\n    if (!componentId || componentId == \"\") {\r\n      componentId = utils.generateUniqueId();\r\n      this.el.setAttribute(\"id\", componentId);\r\n    }\r\n    \r\n    // Check to see if there's slotted content\r\n    let innerHTML = this.el.innerHTML.trim();\r\n\r\n    if (innerHTML != \"\" && innerHTML != \"<!---->\") {\r\n      this.slottedContent = innerHTML;\r\n    } else {\r\n      this.slottedContent = null;\r\n    }\r\n\r\n  }\r\n\r\n\r\n\r\n  render() {\r\n\r\n    let modalOverlayCSS = \"yeti-modal-overlay yeti-modal-overlay-light\";\r\n\r\n    let baseLoading =\r\n\r\n      <div class=\"yeti-loading\" tabindex=\"-1\">\r\n\r\n        <div class=\"yeti-loading-icon\">\r\n            <svg class=\"yeti-loading-icon-svg\" viewBox=\"0 0 100 100\" aria-hidden=\"true\">\r\n                <circle class=\"yeti-loading-icon-svg-circle\" cx=\"50%\" cy=\"50%\" r=\"44\"></circle>\r\n            </svg>\r\n        </div>\r\n\r\n        <div class=\"yeti-loading-label\">Loading...</div>\r\n\r\n        {(this.slottedContent == null && this.slottedContent != \"<!---->\") ?\r\n          \r\n          \"\"\r\n\r\n        :\r\n        \r\n          <div class=\"yeti-loading-content\">\r\n            \r\n            <slot />\r\n          \r\n          </div>\r\n        }\r\n\r\n      </div>\r\n\r\n\r\n    let inlineLoading = \r\n    \r\n      <div class=\"yeti-loading_inline\">\r\n          \r\n        <div class=\"yeti-loading_inline-icon\">\r\n            <svg class=\"yeti-loading_inline-icon-svg\" viewBox=\"0 0 100 100\">\r\n                <circle class=\"yeti-loading_inline-icon-svg-background\" cx=\"50%\" cy=\"50%\" r=\"44\"></circle>\r\n                <circle class=\"yeti-loading_inline-icon-svg-stroke\" cx=\"50%\" cy=\"50%\" r=\"44\"></circle>\r\n            </svg>\r\n        </div>\r\n\r\n        <div class=\"yeti-loading_inline-label\">Loading...</div>\r\n      \r\n      </div>;\r\n\r\n\r\n    modalOverlayCSS += (this.isActive) ? \"\" : \" yeti-modal-overlay__inert\";\r\n\r\n    return (\r\n      (this.isModal) ?\r\n\r\n        <div class={modalOverlayCSS}>\r\n          <div class=\"yeti-modal yeti-modal-size-xs\">\r\n              {baseLoading}\r\n          </div>\r\n        </div>\r\n\r\n      :\r\n\r\n        (this.isInline) ? inlineLoading : baseLoading\r\n\r\n    );\r\n  }\r\n\r\n\r\n\r\n  componentDidRender() {\r\n    // Handle focus management. We can't do this when the property changes because the inactive state uses display: none,\r\n    // which interferes with the ability to accept focus depending on some race conditions.\r\n\r\n    if (this.shouldStealFocus) {\r\n      // Becoming active, take focus\r\n      let loadingDiv = this.el.getElementsByClassName(\"yeti-loading\")[0] as HTMLElement;\r\n      this.previouslyFocusedElement = document.activeElement as HTMLElement;\r\n      loadingDiv.focus();\r\n    }\r\n\r\n    if (this.shouldReturnFocus) {\r\n      // Becoming inactive, return focus\r\n      if (this.previouslyFocusedElement) {\r\n        this.previouslyFocusedElement.focus();\r\n      }\r\n    }\r\n\r\n    this.shouldStealFocus = false;\r\n    this.shouldReturnFocus = false;\r\n  }\r\n\r\n}\r\n"],"names":[],"mappings":"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"}