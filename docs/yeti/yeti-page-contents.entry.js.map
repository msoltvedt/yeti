{"file":"yeti-page-contents.entry.esm.js","mappings":"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","names":[],"sources":["src/components/yeti-page-contents/yeti-page-contents.tsx"],"sourcesContent":["import { Component, Prop, h, Element } from '@stencil/core';\r\nimport { utils, YetiPageContentsHeader } from '../../utils/utils';\r\n\r\n@Component({\r\n  tag: 'yeti-page-contents',\r\n  shadow: false,\r\n})\r\nexport class YetiPageContents {\r\n\r\n  @Element() el: HTMLElement;\r\n\r\n  /**\r\n   * Whether to show the Page Contents menu in expanded or closed state.\r\n   */\r\n  @Prop() isExpanded: boolean = true;\r\n\r\n\r\n  /**\r\n   * Whether to show the Page Contents menu in expanded or closed state.\r\n   */\r\n  @Prop({\r\n    mutable: true,\r\n    reflect: true\r\n  }) wrapperId: string = \"\"; // Will be set in componentWillLoad;\r\n\r\n\r\n  /**\r\n   * Headings within a parent of the given class will be ignored.\r\n   */\r\n  @Prop() ignoreWithin: string = \"\";\r\n\r\n\r\n  /**\r\n   * An array of objects containing the heading names and ids.\r\n   */\r\n  headings: YetiPageContentsHeader[] = []; // Will be set in componentWillLoad;\r\n\r\n\r\n  componentWillLoad() {\r\n    \r\n    let elId = this.el.id;\r\n    let elsParent;\r\n    let elsGrandparent;\r\n    let headingElements;\r\n    let pageWrapper = document.createElement(\"div\");\r\n    let headingIds = [];\r\n    pageWrapper.classList.add(\"yeti-page_contents-wrapper\");\r\n\r\n    // Hide this whole component from screen-readers (since they have a better version built in)\r\n    this.el.setAttribute(\"aria-hidden\", \"true\");\r\n\r\n    // Set up ids\r\n    if (!elId) {\r\n      elId = utils.generateUniqueId();\r\n      this.wrapperId = `${elId}_wrapper`;\r\n    }\r\n\r\n    // Set up page structure:\r\n    // - Wrap el's parent in a new div with class .yeti-page_contents-wrapper\r\n    // - Move the parent into that div\r\n    // - Make el a sibling of parent\r\n    elsParent = this.el.parentElement;\r\n    elsGrandparent = elsParent.parentElement;\r\n\r\n    if (!elsParent || !elsGrandparent) {\r\n      console.warn(\"yeti-page-contents requires containing parent and grandparent elements.\");\r\n      return;\r\n    }\r\n\r\n    elsParent.classList.add(\"yeti-page_contents-wrappee\");\r\n\r\n    elsGrandparent.insertBefore(pageWrapper, elsParent);\r\n    pageWrapper.appendChild(elsParent);\r\n    pageWrapper.appendChild(this.el);\r\n\r\n    // Build the list of headings\r\n    if (this.ignoreWithin != '') {\r\n      headingElements = elsParent.querySelectorAll(`:is(h1, h2, h3, h4, h5, h6):not(.${this.ignoreWithin} :is(h1, h2, h3, h4, h5, h6))`); // All h1, h2, h3, h4, h5, h6 elements that are not children of a parent with the ignore class\r\n    } else {\r\n      headingElements = elsParent.querySelectorAll(\"h1, h2, h3, h4, h5, h6\");\r\n    }\r\n    \r\n\r\n    for (let i = 0; i < headingElements.length; i++) {\r\n      \r\n      let heading = headingElements[i]; // Actual heading HTMLElement\r\n      let candidateId; // Potential id for the heading element.\r\n      let newHeading: YetiPageContentsHeader = {\r\n        label: \"\",\r\n        id: \"\",\r\n        level: 1\r\n      };\r\n\r\n      candidateId = (heading.id && heading.id != '') ? heading.id : heading.innerText.replaceAll(' ', ''); // If the id doesn't have an id then give it one.\r\n\r\n      candidateId = (headingIds.includes(candidateId)) ? utils.generateUniqueId() : candidateId; // Base the id on the heading text if it would be unique, otherwise generate a unique id.\r\n\r\n      newHeading.label = heading.innerText;\r\n      newHeading.id = candidateId;\r\n      newHeading.level = parseInt((heading.nodeName).substring(1)); // Get the \"n\" in Hn (e.g. 2 in H2)\r\n      \r\n      this.headings.push(newHeading);\r\n      headingIds.push(candidateId);\r\n      heading.id = candidateId;\r\n    }\r\n\r\n  }\r\n\r\n\r\n\r\n  render() {\r\n\r\n    let wrapperCSS = \"yeti-page_contents\";\r\n\r\n    if (!this.isExpanded) {\r\n      wrapperCSS += \" yeti-page_contents__collapsed\";\r\n    }\r\n\r\n    return (\r\n      \r\n      <div class={wrapperCSS} id={this.wrapperId}>\r\n\r\n        {(!this.isExpanded) ? \r\n          <button class=\"yeti-page_contents-minmax\" title='Expand page contents' onClick={(e) => {\r\n            e.preventDefault();\r\n            e.stopImmediatePropagation();\r\n            this.isExpanded = true;\r\n          }}><yeti-icon iconCode='toc'></yeti-icon></button> \r\n        : \r\n          \"\"}\r\n\r\n        <ul class=\"yeti-page_contents-headings\">\r\n\r\n          {this.headings.map((heading, index) => {\r\n\r\n              let css = `yeti-page_contents-heading yeti-page_contents-heading-level-${heading.level}`;\r\n              let href = `#${heading.id}`;\r\n              let myId = `${heading.id}_entry`;\r\n              let label = heading.label;\r\n              let minimize = {};\r\n\r\n              if (index == 0) {\r\n                // Render the minimize icon for the first one.\r\n                css += ' yeti-page_contents-heading-title';\r\n                minimize = <button class=\"yeti-page_contents-minmax\" title='Minimize' onClick={(e) => {\r\n                  e.preventDefault();\r\n                  e.stopImmediatePropagation();\r\n                  this.isExpanded = false;\r\n                }}><yeti-icon iconCode='minimize'></yeti-icon></button>;\r\n              }\r\n\r\n              return <li class={css} id={myId} key={myId}>\r\n                <a href={href} onClick={(e) => {\r\n                  e.preventDefault();\r\n                  e.stopImmediatePropagation();\r\n                  document.getElementById(heading.id).scrollIntoView({ behavior: \"smooth\", inline: \"start\" });\r\n                }}>{label}{(index == 0) ? minimize : ''}</a>\r\n              </li>;\r\n            })\r\n          }\r\n\r\n          <li class='yeti-page_contents-heading-actions'>\r\n            \r\n            <a href='' title=\"Back to top\" onClick={(e) => {\r\n              e.preventDefault();\r\n              e.stopImmediatePropagation();\r\n              document.body.scrollIntoView({ behavior: \"smooth\", inline: \"start\" });\r\n            }} class='yeti-page_contents-heading-action'><yeti-icon iconCode='vertical_align_top'></yeti-icon></a>\r\n            \r\n            <a href='' title=\"Collapse all code blocks\" onClick={(e) => {\r\n              \r\n              let demoes = document.getElementsByClassName(\"ydoc-code_sample\");\r\n          \r\n              e.preventDefault();\r\n              e.stopImmediatePropagation();\r\n          \r\n              for (let i = 0; i < demoes.length; i++) {\r\n                demoes[i].classList.remove(\"ydoc-demo__code_expanded\");\r\n              }\r\n\r\n            }} class='yeti-page_contents-heading-action'><yeti-icon iconCode='unfold_less_double'></yeti-icon></a>\r\n            \r\n            <a href='' title=\"Expand all code blocks\" onClick={(e) => {\r\n              \r\n              let demoes = document.getElementsByClassName(\"ydoc-code_sample\");\r\n          \r\n              e.preventDefault();\r\n              e.stopImmediatePropagation();\r\n          \r\n              for (let i = 0; i < demoes.length; i++) {\r\n                demoes[i].classList.add(\"ydoc-demo__code_expanded\");\r\n              }\r\n\r\n            }} class='yeti-page_contents-heading-action'><yeti-icon iconCode='unfold_more_double'></yeti-icon></a>\r\n\r\n          </li>\r\n\r\n        </ul>\r\n\r\n      </div>\r\n\r\n    );\r\n  }\r\n\r\n\r\n\r\n  componentDidLoad() {\r\n    // Set up the Intersection Observer stuff (so we can style the list item whose heading is in view)\r\n\r\n    let headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');\r\n    let observer;\r\n    let options = {\r\n      root: null,\r\n      rootMargin: '0px',\r\n      threshold: 1\r\n    };\r\n\r\n    observer = new IntersectionObserver(handleIntersect, options);\r\n\r\n    headings.forEach(heading => {\r\n      observer.observe(heading);\r\n    });\r\n\r\n    function handleIntersect(entries) {\r\n      \r\n      entries.forEach( (entry) => {\r\n\r\n        let myCorrespondingEntry = document.querySelector(`#${entry.target.id}_entry`);\r\n        //let allCorrespondingEntries = document.querySelectorAll(\".yeti-page_contents-heading\");\r\n\r\n        if (entry.isIntersecting && entry.target.nodeName != \"H1\") {\r\n\r\n          // allCorrespondingEntries.forEach( oneOfAllEntries => {\r\n          //   oneOfAllEntries.classList.remove(\"yeti-page_contents-heading__visible\");\r\n          // });\r\n\r\n          if (myCorrespondingEntry && myCorrespondingEntry.classList) {\r\n            myCorrespondingEntry.classList.add(\"yeti-page_contents-heading__visible\");\r\n          }\r\n        \r\n        } else {\r\n\r\n          if (myCorrespondingEntry && myCorrespondingEntry.classList) {\r\n            myCorrespondingEntry.classList.remove(\"yeti-page_contents-heading__visible\");\r\n          }\r\n\r\n        }\r\n\r\n      });\r\n\r\n    }\r\n\r\n  }\r\n  \r\n\r\n}\r\n"],"version":3}