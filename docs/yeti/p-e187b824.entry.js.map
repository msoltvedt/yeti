{"version":3,"names":["YetiReorderer","constructor","hostRef","this","wrapperClass","iLoveJSX","handleReorderRequested","event","mover","el","querySelector","detail","assignedId","moverPosition","position","moverChild","moverRect","getBoundingClientRect","isUp","swapeePosition","swapee","swapeeChild","swapeeRect","moverYDelta","y","height","swapeeYDelta","that","isDisabled","addEventListener","handleTransitionEnd","style","setProperty","placement","insertAdjacentElement","removeProperty","attributes","value","removeEventListener","reorderCompleted","emit","componentWillLoad","reorderees","querySelectorAll","myId","id","utils","generateUniqueId","length","console","warn","i","render","h","key","class"],"sources":["src/components/yeti-reorderer/yeti-reorderer.tsx"],"sourcesContent":["import { Component, Prop, h, State, Element, Event, EventEmitter, Listen } from '@stencil/core';\r\nimport { utils } from '../../utils/utils';\r\n\r\n@Component({\r\n  tag: 'yeti-reorderer',\r\n  shadow: false,\r\n})\r\nexport class YetiReorderer {\r\n\r\n  @Element() el: HTMLElement;\r\n\r\n\r\n  @Event() reorderCompleted: EventEmitter;\r\n\r\n\r\n  /**\r\n   * CSS class list that should apply to the top-most wrapper element.\r\n   */\r\n  @Prop() wrapperClass: string = '';\r\n\r\n  /**\r\n   * Used to toggle a re-render of the icon.\r\n   */\r\n  @State() iLoveJSX: boolean = false;\r\n\r\n\r\n  @Listen(\"reorderRequested\")\r\n  handleReorderRequested(event) {\r\n    let mover = this.el.querySelector(`#${event.detail.assignedId}`);\r\n    let moverPosition = event.detail.position;\r\n    let moverChild = mover.querySelector(\".yeti-reorderee\") as HTMLElement;\r\n    let moverRect = moverChild.getBoundingClientRect();\r\n    let isUp = event.detail.isUp;\r\n    let swapeePosition = (isUp) ? moverPosition - 1 : moverPosition + 1;\r\n    let swapee = this.el.querySelector(`[position='${swapeePosition}']`);\r\n    let swapeeChild = swapee.querySelector(\".yeti-reorderee\") as HTMLElement;\r\n    let swapeeRect = swapeeChild.getBoundingClientRect();\r\n    let moverYDelta = (isUp) ? swapeeRect.y - moverRect.y : /* i.e. just move it up to where the swapee is */\r\n      swapeeRect.height + (swapeeRect.y - moverRect.y - moverRect.height); // Move it down by height of swapee + distance between mover and swapee.\r\n    let swapeeYDelta = (isUp) ? moverRect.height + (moverRect.y - swapeeRect.y - swapeeRect.height) : moverRect.y - swapeeRect.y;\r\n    let that = this; // So we can reference the class object inside a proper function later on.\r\n\r\n    if (event.detail.isDisabled) {\r\n      // This is just to be safe; Reorderee should never emit a reorderRequested event on a disabled trigger.\r\n      return;\r\n    }\r\n    \r\n    // Move mover into swapee's place\r\n    moverChild.addEventListener('transitionend', handleTransitionEnd);\r\n    moverChild.style.setProperty('transition', 'transform 300ms');\r\n    swapeeChild.style.setProperty('transition', 'transform 300ms');\r\n    moverChild.style.setProperty('transform', `translateY(${moverYDelta}px)`);\r\n    swapeeChild.style.setProperty('transform', `translateY(${swapeeYDelta}px)`);\r\n\r\n    function handleTransitionEnd() {\r\n      let placement = ((isUp) ? 'beforebegin' : 'afterend') as InsertPosition;\r\n      swapee.insertAdjacentElement(placement, mover);\r\n      moverChild.style.removeProperty('transition');\r\n      swapeeChild.style.removeProperty('transition');\r\n      moverChild.style.removeProperty('transform');\r\n      swapeeChild.style.removeProperty('transform');\r\n      \r\n      // Update positions\r\n      mover.attributes[\"position\"].value = swapeePosition;\r\n      swapee.attributes[\"position\"].value = moverPosition;\r\n\r\n      // Detach listener\r\n      moverChild.removeEventListener('transitionend', handleTransitionEnd);\r\n\r\n      // Notify of completion\r\n      that.reorderCompleted.emit();\r\n    }\r\n\r\n  } \r\n\r\n\r\n\r\n  componentWillLoad() {\r\n    // Set up ids for this instance and its child yeti-reorderees. Set position and reorderees attributes for children.\r\n    let reorderees = this.el.querySelectorAll(\"yeti-reorderee\");\r\n    let myId = (this.el.id) ? this.el.id : utils.generateUniqueId();\r\n\r\n    if (typeof reorderees == 'undefined' || !reorderees.length || reorderees.length < 1) {\r\n      console.warn(\"yeti-reorderer should contain at least one yeti-reorderee element.\");\r\n      return;\r\n    }\r\n\r\n    for (let i = 0; i < reorderees.length; i++) {\r\n      reorderees[i].assignedId = reorderees[i].id = `${myId}_reorderee_${i}`;\r\n      reorderees[i].position = i;\r\n      reorderees[i].reorderees = reorderees.length;\r\n    }\r\n\r\n  }\r\n\r\n\r\n\r\n  render() {\r\n\r\n    let wrapperClass = \"yeti-reorderer\";\r\n\r\n    if (this.wrapperClass != '') {\r\n      wrapperClass += ` ${this.wrapperClass}`;\r\n    }\r\n\r\n    return (\r\n\r\n        <ul class={wrapperClass}><slot /></ul>\r\n\r\n    );\r\n  }\r\n\r\n}"],"mappings":"mGAOaA,EAAa,MAJ1B,WAAAC,CAAAC,G,2DAeUC,KAAYC,aAAW,GAKtBD,KAAQE,SAAY,KAyF9B,CArFC,sBAAAC,CAAuBC,GACrB,IAAIC,EAAQL,KAAKM,GAAGC,cAAc,IAAIH,EAAMI,OAAOC,cACnD,IAAIC,EAAgBN,EAAMI,OAAOG,SACjC,IAAIC,EAAaP,EAAME,cAAc,mBACrC,IAAIM,EAAYD,EAAWE,wBAC3B,IAAIC,EAAOX,EAAMI,OAAOO,KACxB,IAAIC,EAAiB,EAASN,EAAgB,EAAIA,EAAgB,EAClE,IAAIO,EAASjB,KAAKM,GAAGC,cAAc,cAAcS,OACjD,IAAIE,EAAcD,EAAOV,cAAc,mBACvC,IAAIY,EAAaD,EAAYJ,wBAC7B,IAAIM,EAAc,EAASD,EAAWE,EAAIR,EAAUQ,EAClDF,EAAWG,QAAUH,EAAWE,EAAIR,EAAUQ,EAAIR,EAAUS,QAC9D,IAAIC,EAAe,EAASV,EAAUS,QAAUT,EAAUQ,EAAIF,EAAWE,EAAIF,EAAWG,QAAUT,EAAUQ,EAAIF,EAAWE,EAC3H,IAAIG,EAAOxB,KAEX,GAAII,EAAMI,OAAOiB,WAAY,CAE3B,M,CAIFb,EAAWc,iBAAiB,gBAAiBC,GAC7Cf,EAAWgB,MAAMC,YAAY,aAAc,mBAC3CX,EAAYU,MAAMC,YAAY,aAAc,mBAC5CjB,EAAWgB,MAAMC,YAAY,YAAa,cAAcT,QACxDF,EAAYU,MAAMC,YAAY,YAAa,cAAcN,QAEzD,SAASI,IACP,IAAIG,EAAa,EAAS,cAAgB,WAC1Cb,EAAOc,sBAAsBD,EAAWzB,GACxCO,EAAWgB,MAAMI,eAAe,cAChCd,EAAYU,MAAMI,eAAe,cACjCpB,EAAWgB,MAAMI,eAAe,aAChCd,EAAYU,MAAMI,eAAe,aAGjC3B,EAAM4B,WAAW,YAAYC,MAAQlB,EACrCC,EAAOgB,WAAW,YAAYC,MAAQxB,EAGtCE,EAAWuB,oBAAoB,gBAAiBR,GAGhDH,EAAKY,iBAAiBC,M,EAO1B,iBAAAC,GAEE,IAAIC,EAAavC,KAAKM,GAAGkC,iBAAiB,kBAC1C,IAAIC,EAAQzC,KAAKM,GAAK,GAAIN,KAAKM,GAAGoC,GAAKC,EAAMC,mBAE7C,UAAWL,GAAc,cAAgBA,EAAWM,QAAUN,EAAWM,OAAS,EAAG,CACnFC,QAAQC,KAAK,sEACb,M,CAGF,IAAK,IAAIC,EAAI,EAAGA,EAAIT,EAAWM,OAAQG,IAAK,CAC1CT,EAAWS,GAAGvC,WAAa8B,EAAWS,GAAGN,GAAK,GAAGD,eAAkBO,IACnET,EAAWS,GAAGrC,SAAWqC,EACzBT,EAAWS,GAAGT,WAAaA,EAAWM,M,EAO1C,MAAAI,GAEE,IAAIhD,EAAe,iBAEnB,GAAID,KAAKC,cAAgB,GAAI,CAC3BA,GAAgB,IAAID,KAAKC,c,CAG3B,OAEIiD,EAAA,MAAAC,IAAA,2CAAIC,MAAOnD,GAAciD,EAAQ,QAAAC,IAAA,6C","ignoreList":[]}